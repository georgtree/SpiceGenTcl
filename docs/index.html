<!DOCTYPE html><html><head><meta charset="utf-8"/>
<title>Tcl SpiceGenTcl package</title>
<link rel='stylesheet' type='text/css' href='assets/ruff-min.css' />
<script type='text/javascript' src='assets/ruff-min.js'></script>
</head>
<body>
<div class='ruff-layout'>
<header class='ruff-layout-header ruff-hd'>
<a style='text-decoration:none;' href='index.html'>Tcl SpiceGenTcl package (v0.52)</a>


            <div id="ruffButtonBar">
            <button id="ruffNavMove" onclick="ruffMoveNavPane()"></button>
            <button id="ruffToggleTheme" onclick="ruffNextTheme()"></button>
            </div>
        </header><main class='ruff-layout-main ruff-bd'><p class='ruff'><img src="assets/img/spicegentcl_logo.svg" alt="drawing" width="700"/></p>
<p class='ruff'>This package provides Tcl interface to different SPICE and SPICE-like simulator, Ngspice, Xyce. It was inspired by <a href="https://github.com/PySpice-org/PySpice" >PySpice</a> project, object-oriented interface to SPICE-like simulators written in Python.</p>
<h2 class='ruff'><a name='General concept'></a>General concept<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>The general concept of the package is to build a netlist using Tcl scripts. It is based on the TclOO object-oriented system, where everything is represented by objects, including elements, models, analyses, waveforms, and netlists. After defining the netlist, you can run the simulation, read the resulting data, and then process or display the data using the Tcl scripting language.</p>
<p class='ruff'>This approach differs from the <a href="https://ngspice.sourceforge.io/tclspice.html" >Tclspice</a> extension, which comes bundled with Ngspice and is tightly bound to the simulator's internal structures. SpiceGenTcl offers a more flexible approach that can be extended to work with different simulators that use netlists with similar syntax.</p>
<h2 class='ruff'><a name='Usage examples'></a>Usage examples<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>SpiceGenTcl can be used if you need:</p>
<ul class='ruff'>
<li>automate some repetitive simulation tasks, and you don't like <a href="https://ngspice.sourceforge.io/ngspice-control-language-tutorial.html" >Nutmeg</a> syntax (SPICE standard scripting language)</li>
<li>postprocess output waveforms and data</li>
<li>change netlist structure on the fly</li>
<li>simulate different models in the same circuit setup</li>
<li>run circuit optimization with parameters variations as well as variations in circuit topology</li>
</ul>
<h2 class='ruff'><a name='Install and dependencies'></a>Install and dependencies<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>To install the package you should extract archive with source code and add path of the package folder to <code>auto_path</code> variable:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#923B23>lappend</font></b> auto_path <font color=#035103>&quot;path to SpiceGenTcl package&quot;</font>
</pre>

</figure><p class='ruff'>Package is written in pure Tcl with relying on Tcllib and ticklecharts, tcl version is 9.0. The only necessary external dependency is the simulator itself.</p>
<ul class='ruff'>
<li><a href="https://ngspice.sourceforge.io/download.html" >Ngspice</a></li>
<li><a href="https://xyce.sandia.gov/downloads/executables/" >Xyce</a></li>
<li><a href="https://www.tcl.tk/software/tcllib/" >Tcllib</a></li>
<li><a href="https://github.com/nico-robert/ticklecharts" >ticklecharts</a></li>
</ul>
<p class='ruff'>After simulator installation add path to executable to <code>PATH</code> environment variable.</p>
<p class='ruff'>For code coverage test <a href="https://nagelfar.sourceforge.net/" >nagelfar</a> is used, commit 845924 of master branch.</p>
<p class='ruff'>For view test coverage diffs <a href="http://eskil.tcl.tk/index.html/doc/trunk/htdocs/index.html" >eskil</a> is used.</p>
<h2 class='ruff'><a name='Documentation and tutorials'></a>Documentation and tutorials<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>Documentation could be found <a href="https://georgtree.github.io/SpiceGenTcl/" >here</a>.</p>
<p class='ruff'>Tutorials describing different examples could be found <a href="https://georgtree.github.io/SpiceGenTcl/index-Tutorials.html" >here</a>.</p>
<p class='ruff'>Good tutorial for Tcl language could be found <a href="http://tcl.tk/man/tcltutorial/html/tcltutorial.html" >here</a></p>
<p class='ruff'>Documentation was generated with <a href="https://ruff.magicsplat.com/" >ruff!</a>.</p>
<p class='ruff'>Tcl syntax highlightning was done with <a href="https://github.com/aplsimple/hl_tcl" >hl_tcl</a>.</p>
<h2 class='ruff'><a name='Supported platforms'></a>Supported platforms<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>I personally use Kubuntu 24.04, and I also tested package on Windows 11. On Kubuntu I use Tcl/Tk 9.0 compiled from sources, as well as Ngspice and Xyce. On Windows I use <a href="https://www.magicsplat.com/tcl-installer/" >Magicsplat</a> distribution of Tcl/Tk 9.0. For Ngspice and Xyce I use precompilled binaries.</p>
<p class='ruff'>Tcl is a cross-platform language, and because this package is written in pure Tcl, you can practically run it on any platform, including Windows, Linux (all flavors), and FreeBSD. Ngspice is available as pre-compiled binaries for Linux and Windows, but it can also be compiled on FreeBSD. Xyce is availible as pre-compiled for Windows, RHEL and MacOS, but can be compiled to any other platform.</p>
<h2 class='ruff'><a name='Quick start'></a>Quick start<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h2>
<div style='clear:both;'></div>
<ul class='ruff'>
<li><font color="red"> <strong>Important note 1</strong></font>: internally, all device names, parameters, nodes, types, reference names, and data vector's names are converted to lowercase after object instantiation. While you can enter them in any case, they can only be accessed by their lowercase names. This approach aligns with the fact that most SPICE simulators are case-insensitive. To prevent ambiguity in Tcl code, where the simulator treats mixed-case names as identical, we convert everything to lowercase. This ensures that we can detect and resolve any duplicate names in the top-level circuit before generating the netlist.</li>
<li><font color="red"> <strong>Important note 2</strong></font>: this package is not designed to be used with the <code>.control</code> section in Ngspice, the .step statement in LTspice, or multiple DC sweeps, and it does not support reading parametric sweeps from raw data. The idea of the package is to handle all such tasks within a Tcl script, eliminating the need to use the simulator's internal scripting capabilities, and dependence on each simulator unique ways of handling parametric sweeps, that compromises compatibility. But it is could be done easily in principle to realize special objects and reading of raw files with parametric sweeps.</li>
</ul>
<h3 class='ruff'><a name='Packages imports'></a>Packages imports<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>The first step is import of package:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#923B23>package</font></b> require SpiceGenTcl
</pre>

</figure><p class='ruff'>Import all commands from ::SpiceGenTcl:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#923B23>namespace</font></b> import ::SpiceGenTcl::*
</pre>

</figure><p class='ruff'>One of the commands is <a href="index-SpiceGenTcl.html#::SpiceGenTcl::importNgspice" title="::SpiceGenTcl::importNgspice" class='ruff_cmd'>::SpiceGenTcl::importNgspice</a>. By calling this command, we can import all commands related to the Ngspice simulator, eliminating the need to add the <code>::SpiceGenTcl::Ngspice</code> prefix before any command. Here's how to do it:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>importNgspice
</pre>

</figure><p class='ruff'>To plot results of simulation we also import package <code>ticklecharts</code>:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#923B23>package</font></b> require ticklecharts
</pre>

</figure><h3 class='ruff'><a name='Circuit definition'></a>Circuit definition<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Let's try to define simple resistor divider circuit with following netlist:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>voltage divider netlist
v1 in 0 1
r1 in out 1e3
r2 out 0 2e3
.dc v1 0 5 0.1
</pre>

</figure><p class='ruff'><img src="assets/img/resistor_divider_cir.png" alt="drawing" width="300"/></p>
<p class='ruff'>First step is creating circuit object:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#923B23>set</font></b> circuit [<b><font color=#923B23>Circuit</font></b> new {voltage divider netlist}]
</pre>

</figure><p class='ruff'>The <code><b><font color=#923B23>Circuit</font></b></code> command creates a new object of the <a href="index-SpiceGenTcl.html#::SpiceGenTcl::Circuit" title="::SpiceGenTcl::Circuit" class='ruff_cmd'>::SpiceGenTcl::Circuit</a> class, which is imported from the <code>::SpiceGenTcl</code> namespace and represents the top-level circuit. The only argument we provide is the name of the circuit, which will be printed on the first line of the netlist.</p>
<p class='ruff'>The next step is building netlist by addding elements to top circuit object:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><font color=#4A181B>$circuit</font> add [<b><font color=#923B23>Vdc</font></b> new 1 in 0 <font color=#463e11>-dc</font> 1]
<font color=#4A181B>$circuit</font> add [<b><font color=#923B23>R</font></b> new 1 in out <font color=#463e11>-r</font> 1e3]
<font color=#4A181B>$circuit</font> add [<b><font color=#923B23>R</font></b> new 2 out 0 <font color=#463e11>-r</font> 2e3]
<font color=#4A181B>$circuit</font> add [<b><font color=#923B23>Dc</font></b> new <font color=#463e11>-src</font> v1 <font color=#463e11>-start</font> 0 <font color=#463e11>-stop</font> 5 <font color=#463e11>-incr</font> 0.1]
</pre>

</figure><p class='ruff'>An instance of the <a href="index-SpiceGenTcl.html#::SpiceGenTcl::Circuit" title="::SpiceGenTcl::Circuit" class='ruff_cmd'>::SpiceGenTcl::Circuit</a> class, referenced by the <code>circuit</code> variable, has an <a href="index-SpiceGenTcl.html#::SpiceGenTcl::Circuit::add" title="::SpiceGenTcl::Circuit::add" class='ruff_cmd'>::SpiceGenTcl::Circuit::add</a> method that appends the references of argument objects to it. The object-creating commands <code><b><font color=#923B23>Vdc</font></b></code>, <code><b><font color=#923B23>R</font></b></code>, and <code><b><font color=#923B23>Dc</font></b></code> — which represent a DC voltage source, a basic resistor, and a DC analysis, respectively — are imported from the <code>::SpiceGenTcl::Ngspice::Sources</code>, <code>::SpiceGenTcl::Ngspice::BasicElements</code>, and <code>::SpiceGenTcl::Ngspice::Analyses</code> namespaces.</p>
<p class='ruff'>When using the <code>new</code> subcommand, you provide the basic arguments for the element. For example, in the <code><b><font color=#923B23>R</font></b></code> command, you would supply the name '1', the name of the net connected to the positive node 'in', the name of the net connected to the negative node '0' (which is the global ground), and the resistance value '1e3'.</p>
<p class='ruff'>The last necessary step is to create <a href="index-SpiceGenTcl.html#::SpiceGenTcl::Simulator" title="::SpiceGenTcl::Simulator" class='ruff_cmd'>::SpiceGenTcl::Simulator</a> object with command <code><b><font color=#923B23>Batch</font></b></code> from <code>::SpiceGenTcl::Ngspice</code> namespace and attach it to <a href="index-SpiceGenTcl.html#::SpiceGenTcl::Circuit" title="::SpiceGenTcl::Circuit" class='ruff_cmd'>::SpiceGenTcl::Circuit</a> object:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#923B23>set</font></b> simulator [<b><font color=#923B23>Batch</font></b> new {batch1} {/usr/local/bin/}]
<font color=#4A181B>$circuit</font> configure <font color=#463e11>-Simulator</font> <font color=#4A181B>$simulator</font>
</pre>

</figure><p class='ruff'>Now we are ready to run simulation:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><font color=#4A181B>$circuit</font> runAndRead
</pre>

</figure><p class='ruff'>After the simulation, we can read the resulting data. We use the <a href="index-SpiceGenTcl.html#::SpiceGenTcl::Circuit::getDataDict" title="::SpiceGenTcl::Circuit::getDataDict" class='ruff_cmd'>::SpiceGenTcl::Circuit::getDataDict</a> method to obtain a dictionary where the keys are the names of the result vectors:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#923B23>set</font></b> data [<font color=#4A181B>$circuit</font> getDataDict]
</pre>

</figure><p class='ruff'>The we can get vectors v(in) and v(out) from dictionary <code>data</code>:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#923B23>set</font></b> axis [<b><font color=#923B23>dict</font></b> get <font color=#4A181B>$data</font> v(in)]
<b><font color=#923B23>set</font></b> trace [<b><font color=#923B23>dict</font></b> get <font color=#4A181B>$data</font> v(out)]
</pre>

</figure><h3 class='ruff'><a name='Plotting data'></a>Plotting data<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>To plot results we use <a href="https://github.com/nico-robert/ticklecharts" ><code>ticklecharts</code></a> package:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#923B23>foreach</font></b> x <font color=#4A181B>$axis</font> y <font color=#4A181B>$trace</font> {
    <b><font color=#923B23>set</font></b> x [<b><font color=#923B23>format</font></b> <font color=#035103>&quot;%.3f&quot;</font> <font color=#4A181B>$x</font>]
    <b><font color=#923B23>set</font></b> y [<b><font color=#923B23>format</font></b> <font color=#035103>&quot;%.3f&quot;</font> <font color=#4A181B>$y</font>]
    <b><font color=#923B23>lappend</font></b> xydata [<b><font color=#923B23>list</font></b> <font color=#4A181B>$x</font> <font color=#4A181B>$y</font>]
}
<b><font color=#923B23>set</font></b> chart [ticklecharts::chart new]
<font color=#4A181B>$chart</font> Xaxis <font color=#463e11>-name</font> <font color=#035103>&quot;v(in), V&quot;</font> <font color=#463e11>-minorTick</font> {show <font color=#035103>&quot;True&quot;</font>} <font color=#463e11>-min</font> 0 <font color=#463e11>-max</font> 5 <font color=#463e11>-type</font> <font color=#035103>&quot;value&quot;</font>
<font color=#4A181B>$chart</font> Yaxis <font color=#463e11>-name</font> <font color=#035103>&quot;v(out), V&quot;</font> <font color=#463e11>-minorTick</font> {show <font color=#035103>&quot;True&quot;</font>} <font color=#463e11>-min</font> 0 <font color=#463e11>-max</font> 3.5 <font color=#463e11>-type</font> <font color=#035103>&quot;value&quot;</font>
<font color=#4A181B>$chart</font> SetOptions <font color=#463e11>-title</font> {} <font color=#463e11>-tooltip</font> {} <font color=#463e11>-animation</font> <font color=#035103>&quot;False&quot;</font> 
<font color=#4A181B>$chart</font> Add <font color=#035103>&quot;lineSeries&quot;</font> <font color=#463e11>-data</font> <font color=#4A181B>$xydata</font> <font color=#463e11>-showAllSymbol</font> <font color=#035103>&quot;nothing&quot;</font>
<b><font color=#923B23>set</font></b> fbasename [<b><font color=#923B23>file</font></b> rootname [<b><font color=#923B23>file</font></b> tail [<b><font color=#923B23>info</font></b> script]]]
<font color=#4A181B>$chart</font> Render <font color=#463e11>-outfile</font> [<b><font color=#923B23>file</font></b> normalize [<b><font color=#923B23>file</font></b> join html_charts <font color=#4A181B>$fbasename</font>.html]]
</pre>

</figure><p class='ruff'>To view result, we should open rendered resistor_divider.html chart in browser.</p>
<p class='ruff'><img src="assets/img/resistor_divider.png" alt="resistor_divider" /></p>
</main><nav class='ruff-nav'><ul ><li class='ruff-toc1'><a class='ruff-highlight' style='padding-top:2px;' href='index.html'>Start page</a></li>
<li class='ruff-toc1'><a href='index-docindex.html' accesskey='i'>Index</a></li>
<hr>
<li class='ruff-toc1'><a href='index-List-of-devices.html'>List of devices</a></li>
<li class='ruff-toc1'><a href='index-FAQ.html'>FAQ</a></li>
<li class='ruff-toc1'><a href='index-Tutorials.html'>Tutorials</a></li>
<li class='ruff-toc1'><a href='index-Tips.html'>Tips</a></li>
<li class='ruff-toc1'><a href='index-Advanced.html'>Advanced</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl.html'>SpiceGenTcl</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Common-BasicDevices.html'>SpiceGenTcl::Common::BasicDevices</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Common-Sources.html'>SpiceGenTcl::Common::Sources</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ngspice-BasicDevices.html'>SpiceGenTcl::Ngspice::BasicDevices</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ngspice-Sources.html'>SpiceGenTcl::Ngspice::Sources</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ngspice-SemiconductorDevices.html'>SpiceGenTcl::Ngspice::SemiconductorDevices</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ngspice-Analyses.html'>SpiceGenTcl::Ngspice::Analyses</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ngspice-Simulators.html'>SpiceGenTcl::Ngspice::Simulators</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Xyce-BasicDevices.html'>SpiceGenTcl::Xyce::BasicDevices</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Xyce-Sources.html'>SpiceGenTcl::Xyce::Sources</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Xyce-SemiconductorDevices.html'>SpiceGenTcl::Xyce::SemiconductorDevices</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Xyce-Analyses.html'>SpiceGenTcl::Xyce::Analyses</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Xyce-Simulators.html'>SpiceGenTcl::Xyce::Simulators</a></li>
<hr><li class='ruff-toc2'><a href='#General concept'>General concept</a></li><li class='ruff-toc2'><a href='#Usage examples'>Usage examples</a></li><li class='ruff-toc2'><a href='#Install and dependencies'>Install and dependencies</a></li><li class='ruff-toc2'><a href='#Documentation and tutorials'>Documentation and tutorials</a></li><li class='ruff-toc2'><a href='#Supported platforms'>Supported platforms</a></li><li class='ruff-toc2'><a href='#Quick start'>Quick start</a></li><li class='ruff-toc3'><a href='#Packages imports'>Packages imports</a></li><li class='ruff-toc3'><a href='#Circuit definition'>Circuit definition</a></li><li class='ruff-toc3'><a href='#Plotting data'>Plotting data</a></li></ul></nav><footer class='ruff-layout-footer ruff-ft'><div style='float: right;'>Document generated by <a href='https://ruff.magicsplat.com'>Ruff!</a></div><div>&copy; George Yashin</div></footer>
</div></body></html>
