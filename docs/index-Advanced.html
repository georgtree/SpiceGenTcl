<!DOCTYPE html><html><head><meta charset="utf-8"/>
<title>Tcl SpiceGenTcl package</title>
<link rel='stylesheet' type='text/css' href='assets/ruff-min.css' />
<script type='text/javascript' src='assets/ruff-min.js'></script>
</head>
<body>
<div class='ruff-layout'>
<header class='ruff-layout-header ruff-hd'>
<a style='text-decoration:none;' href='index.html'>Tcl SpiceGenTcl package (v0.65)</a>


            <div id="ruffButtonBar">
            <button id="ruffNavMove" onclick="ruffMoveNavPane()"></button>
            <button id="ruffToggleTheme" onclick="ruffNextTheme()"></button>
            </div>
        </header><main class='ruff-layout-main ruff-bd'><h1 class='ruff'><a name='Advanced'></a>Advanced<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h1>
<div style='clear:both;'></div>
<p class='ruff'>This section provides advanced examples from the <code>examples</code> folder in the root directory of <em>SpiceGenTcl</em>. Rather than focusing on basic operations, we highlight advanced use cases that showcase the full capabilities of both the package and the Tcl language. List of availible examples:</p>
<ul class='ruff'>
<li><a href="index-Advanced.html#::Advanced-Monte-Carlo simulation" title="Monte-Carlo simulation" >Monte-Carlo simulation</a> - &quot;examples/ngspice/advanced/monte_carlo.tcl&quot; and &quot;examples/xyce/advanced/monte_carlo.tcl&quot; file</li>
<li><a href="index-Advanced.html#::Advanced-Parameters extraction of diode model parameters" title="Parameters extraction of diode model parameters" >Parameters extraction of diode model parameters</a> - &quot;examples/ngspice/advanced/diode_extract.tcl&quot; file</li>
</ul>
<h2 class='ruff'><a name='::Advanced-Monte-Carlo simulation'></a>Monte-Carlo simulation<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>This example demonstrates multiple runs of a simple filter circuit and the collection of the resulting statistical distribution of frequency bandwidths. The original circuit source is from the ngspice source distribution. The target filter circuit is:</p>
<p class='ruff'><img src="assets/img/monte_carlo_cir.png" alt="drawing" width="700"/></p>
<p class='ruff'>The filter is a 3rd-order Chebyshev bandpass. The first step is to build the circuit and obtain the magnitude of the transfer characteristic:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><i><font color=#76a396># create top-level circuit</font></i>
<b><font color=#ffa500>set</font></b> circuit [<b><font color=#ffa500>Circuit</font></b> new {Monte-Carlo}]
<i><font color=#76a396># add elements to circuit</font></i>
<font color=#f1b479>$circuit</font> add [<b><font color=#ffa500>Vac</font></b> new 1 n001 0 <font color=#b9b96e>-ac</font> 1]
<font color=#f1b479>$circuit</font> add [<b><font color=#ffa500>R</font></b> new 1 n002 n001 <font color=#b9b96e>-r</font> 141]
<font color=#f1b479>$circuit</font> add [<b><font color=#ffa500>R</font></b> new 2 0 out <font color=#b9b96e>-r</font> 141]
<b><font color=#ffa500>C</font></b> create c1 1 out 0 <font color=#b9b96e>-c</font> 1e-9
<b><font color=#ffa500>L</font></b> create l1 1 out 0 <font color=#b9b96e>-l</font> 10e-6
<b><font color=#ffa500>C</font></b> create c2 2 n002 0 <font color=#b9b96e>-c</font> 1e-9
<b><font color=#ffa500>L</font></b> create l2 2 n002 0 <font color=#b9b96e>-l</font> 10e-6
<b><font color=#ffa500>C</font></b> create c3 3 out n003 <font color=#b9b96e>-c</font> 250e-12
<b><font color=#ffa500>L</font></b> create l3 3 n003 n002 <font color=#b9b96e>-l</font> 40e-6
<b><font color=#ffa500>foreach</font></b> elem [<b><font color=#ffa500>list</font></b> c1 l1 c2 l2 c3 l3] {
    <font color=#f1b479>$circuit</font> add <font color=#f1b479>$elem</font>
}
<font color=#f1b479>$circuit</font> add [<b><font color=#ffa500>Ac</font></b> new <font color=#b9b96e>-variation</font> oct <font color=#b9b96e>-n</font> 100 <font color=#b9b96e>-fstart</font> 250e3 <font color=#b9b96e>-fstop</font> 10e6]
<i><font color=#76a396>#set simulator with default </font></i>
<b><font color=#ffa500>set</font></b> simulator [<b><font color=#ffa500>Batch</font></b> new {batch1}]
<i><font color=#76a396># attach simulator object to circuit</font></i>
<font color=#f1b479>$circuit</font> configure <font color=#b9b96e>-simulator</font> <font color=#f1b479>$simulator</font>

</pre>

</figure><p class='ruff'>Here, we use a different method for creating a class instance: <code>create</code> instead of <code>new</code>. With <code>create</code>, we can directly set a custom object reference name, rather than relying on the automatically generated one by Tcl.</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>C</font></b> create c1 1 out 0 <font color=#b9b96e>-c</font> 1e-9
</pre>

</figure><p class='ruff'>Keep in mind that <code>c1</code> is an object reference, not the name of a variable storing the reference. Therefore, it can be used as an object command directly, without the need for a <code>$</code>.</p>
<p class='ruff'>To calculate the magnitude of the transfer function in dB scale from the output voltage phasor, we create a procedure:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#fe6efe>proc</font></b> calcDbMag {re im} {
    <b><font color=#ffa500>set</font></b> mag [= {sqrt(<font color=#f1b479>$re</font>*<font color=#f1b479>$re</font>+<font color=#f1b479>$im</font>*<font color=#f1b479>$im</font>)}]
    <b><font color=#ffa500>set</font></b> db [= {10*log(<font color=#f1b479>$mag</font>)}]
    <b><font color=#fe6efe>return</font></b> <font color=#f1b479>$db</font>
}

<b><font color=#fe6efe>proc</font></b> calcDbMagVec {vector} {
    <b><font color=#ffa500>foreach</font></b> value <font color=#f1b479>$vector</font> {
        <b><font color=#ffa500>lappend</font></b> db [calcDbMag [@ <font color=#f1b479>$value</font> 0] [@ <font color=#f1b479>$value</font> 1]]
    }
    <b><font color=#fe6efe>return</font></b> <font color=#f1b479>$db</font>
}
</pre>

</figure><table class='ruff_deflist'>
<tr><td><code>calcDbMagVec</code></td><td>Procedure that apply <code>calcDbMag</code> to list of complex values.</td></tr>
</table>
<p class='ruff'>Run and plot the result:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><i><font color=#76a396># run simulation</font></i>
<font color=#f1b479>$circuit</font> runAndRead
<i><font color=#76a396># get data dictionary</font></i>
<b><font color=#ffa500>set</font></b> data [<font color=#f1b479>$circuit</font> getDataDict]
<b><font color=#ffa500>set</font></b> trace [calcDbMagVec [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$data</font> v(out)]]
<b><font color=#ffa500>set</font></b> freqs [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$data</font> frequency]
<b><font color=#ffa500>foreach</font></b> x <font color=#f1b479>$freqs</font> y <font color=#f1b479>$trace</font> {
    <b><font color=#ffa500>lappend</font></b> xydata [<b><font color=#ffa500>list</font></b> [@ <font color=#f1b479>$x</font> 0] <font color=#f1b479>$y</font>]
}
<b><font color=#ffa500>puts</font></b> [findBW [<b><font color=#ffa500>lmap</font></b> freq <font color=#f1b479>$freqs</font> {@ <font color=#f1b479>$freq</font> 0}] <font color=#f1b479>$trace</font> -10]
<b><font color=#ffa500>set</font></b> chartTransMag [ticklecharts::chart new]
<font color=#f1b479>$chartTransMag</font> Xaxis <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;Frequency, Hz&quot;</font> <font color=#b9b96e>-minorTick</font> {show <font color=#90ee90>&quot;True&quot;</font>} <font color=#b9b96e>-type</font> <font color=#90ee90>&quot;log&quot;</font> <font color=#b9b96e>-splitLine</font> {show <font color=#90ee90>&quot;True&quot;</font>}
<font color=#f1b479>$chartTransMag</font> Yaxis <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;Magnitude, dB&quot;</font> <font color=#b9b96e>-minorTick</font> {show <font color=#90ee90>&quot;True&quot;</font>} <font color=#b9b96e>-type</font> <font color=#90ee90>&quot;value&quot;</font> <font color=#b9b96e>-splitLine</font> {show <font color=#90ee90>&quot;True&quot;</font>}
<font color=#f1b479>$chartTransMag</font> SetOptions <font color=#b9b96e>-title</font> {} <font color=#b9b96e>-tooltip</font> {trigger <font color=#90ee90>&quot;axis&quot;</font>} <font color=#b9b96e>-animation</font> <font color=#90ee90>&quot;False&quot;</font> <font color=#b9b96e>-toolbox</font> {feature {dataZoom {yAxisIndex <font color=#90ee90>&quot;none&quot;</font>}}} <font color=#b9b96e>-grid</font> {left <font color=#90ee90>&quot;10%&quot;</font> right <font color=#90ee90>&quot;15%&quot;</font>} <font color=#b9b96e>-backgroundColor</font> <font color=#90ee90>&quot;#212121&quot;</font>
<font color=#f1b479>$chartTransMag</font> Add <font color=#90ee90>&quot;lineSeries&quot;</font> <font color=#b9b96e>-data</font> <font color=#f1b479>$xydata</font> <font color=#b9b96e>-showAllSymbol</font> <font color=#90ee90>&quot;nothing&quot;</font> <font color=#b9b96e>-symbolSize</font> <font color=#90ee90>&quot;1&quot;</font>
<b><font color=#ffa500>set</font></b> fbasename [<b><font color=#ffa500>file</font></b> rootname [<b><font color=#ffa500>file</font></b> tail [<b><font color=#ffa500>info</font></b> script]]]
<font color=#f1b479>$chartTransMag</font> Render <font color=#b9b96e>-outfile</font> [<b><font color=#ffa500>file</font></b> normalize [<b><font color=#ffa500>file</font></b> join .. html_charts <font color=#f1b479>${fbasename}</font>_typ.html]] <font color=#b9b96e>-width</font> 1000px
</pre>

</figure><p class='ruff'><!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>ticklEcharts !!!</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
  </head>
  <body>
    <div id="id_8373210d0bab4f099548c1ba613d988f" class="chart-container" style="width:1000px; height:500px;"></div>
    <script>
      var chart_8373210d0bab4f099548c1ba613d988f = echarts.init(document.getElementById("id_8373210d0bab4f099548c1ba613d988f"), null, {renderer: "canvas"});
      var option_8373210d0bab4f099548c1ba613d988f = {
  "xAxis": [{
      "show": true,
      "type": "log",
      "gridIndex": 0,
      "position": "bottom",
      "name": "Frequency, Hz",
      "nameLocation": "end",
      "nameGap": 15,
      "nameRotate": 0,
      "inverse": false,
      "boundaryGap": true,
      "scale": false,
      "silent": false,
      "triggerEvent": false,
      "axisLine": {
        "show": true,
        "lineStyle": {
          "color": "#B9B8CE",
          "width": 1
        }
      },
      "axisTick": {"show": true},
      "minorTick": {
        "show": true,
        "splitNumber": 5,
        "length": 3
      },
      "axisLabel": {"color": "#B9B8CE"},
      "splitLine": {
        "show": true,
        "onZero": true,
        "symbol": null,
        "lineStyle": {
          "color": "#484753",
          "width": 1
        }
      },
      "zlevel": 0,
      "z": 0
    }],
  "yAxis": [{
      "show": true,
      "gridIndex": 0,
      "position": "left",
      "realtimeSort": true,
      "sortSeriesIndex": 0,
      "type": "value",
      "name": "Magnitude, dB",
      "nameLocation": "end",
      "nameGap": 15,
      "nameRotate": 0,
      "inverse": false,
      "boundaryGap": false,
      "scale": false,
      "silent": false,
      "triggerEvent": false,
      "axisLine": {
        "show": true,
        "lineStyle": {
          "color": "#B9B8CE",
          "width": 1
        }
      },
      "axisTick": {"show": true},
      "minorTick": {
        "show": true,
        "splitNumber": 5,
        "length": 3
      },
      "axisLabel": {"color": "#B9B8CE"},
      "splitLine": {
        "show": true,
        "onZero": true,
        "symbol": null,
        "lineStyle": {
          "color": "#484753",
          "width": 1
        }
      },
      "zlevel": 0,
      "z": 0
    }],
  "darkMode": true,
  "backgroundColor": "#212121",
  "color": [
    "#4992ff",
    "#7cffb2",
    "#fddd60",
    "#ff6e76",
    "#58d9f9",
    "#05c091",
    "#ff8a45",
    "#8d48e3",
    "#dd79ff"
  ],
  "animation": false,
  "animationDuration": 1000,
  "animationDurationUpdate": 500,
  "animationEasing": "cubicInOut",
  "animationEasingUpdate": "cubicInOut",
  "animationThreshold": 2000,
  "progressiveThreshold": 3000,
  "title": [{
      "show": true,
      "target": "blank",
      "textStyle": {"color": "#EEF1FA"},
      "subtarget": "blank",
      "subtextStyle": {"color": "#B9B8CE"},
      "textAlign": null,
      "textVerticalAlign": "auto",
      "padding": 5,
      "itemGap": 10,
      "z": 2,
      "left": "auto",
      "top": "auto",
      "right": "auto",
      "bottom": "auto",
      "backgroundColor": "transparent",
      "borderColor": "transparent",
      "borderWidth": 1,
      "borderRadius": 0
    }],
  "tooltip": [{
      "show": true,
      "trigger": "axis",
      "showContent": true,
      "alwaysShowContent": false,
      "triggerOn": "mousemove|click",
      "transitionDuration": 0.4,
      "padding": 5,
      "order": "seriesAsc"
    }],
  "grid": [{
      "left": "10%",
      "right": "15%"
    }],
  "toolbox": {
    "show": true,
    "orient": "horizontal",
    "itemSize": 15,
    "itemGap": 10,
    "showTitle": true,
    "feature": {"dataZoom": {
        "show": true,
        "filterMode": "filter",
        "yAxisIndex": "none"
      }},
    "iconStyle": {"borderColor": "#B9B8CE"},
    "z": 2,
    "top": "auto",
    "right": "auto",
    "width": "auto",
    "height": "auto"
  },
  "series": [{
      "type": "line",
      "name": "lineseries_1",
      "colorBy": "series",
      "coordinateSystem": "cartesian2d",
      "symbol": "circle",
      "symbolSize": 1,
      "symbolKeepAspect": true,
      "showSymbol": true,
      "legendHoverLink": true,
      "cursor": "pointer",
      "connectNulls": false,
      "clip": true,
      "triggerLineEvent": false,
      "step": false,
      "label": {"color": "#B9B8CE"},
      "smooth": false,
      "data": [
        [
          250000.0,
          -72.0801940221616
        ],
        [
          251738.88751417972,
          -71.86166537921983
        ],
        [
          253489.8699475073,
          -71.6429851911043
        ],
        [
          255253.03142679835,
          -71.42415123323526
        ],
        [
          257028.45666401667,
          -71.20516124680492
        ],
        [
          258816.23096034443,
          -70.98601293820577
        ],
        [
          260616.44021028042,
          -70.7667039784483
        ],
        [
          262429.1709057669,
          -70.54723200256733
        ],
        [
          264254.5101403452,
          -70.32759460901727
        ],
        [
          266092.5456133401,
          -70.10778935905587
        ],
        [
          267943.36563407345,
          -69.88781377611589
        ],
        [
          269807.05912610696,
          -69.667665345165
        ],
        [
          271683.71563151473,
          -69.44734151205317
        ],
        [
          273573.4253151851,
          -69.22683968284746
        ],
        [
          275476.2789691529,
          -69.00615722315389
        ],
        [
          277392.3680169615,
          -68.78529145742621
        ],
        [
          279321.78451805527,
          -68.56423966826102
        ],
        [
          281264.62117220263,
          -68.34299909567916
        ],
        [
          283220.97132395,
          -68.12156693639294
        ],
        [
          285190.9289671063,
          -67.89994034305892
        ],
        [
          287174.5887492591,
          -67.67811642351593
        ],
        [
          289172.04597632226,
          -67.45609224000789
        ],
        [
          291183.39661711437,
          -67.23386480839119
        ],
        [
          293208.7373079701,
          -67.01143109732615
        ],
        [
          295248.165357383,
          -66.78878802745233
        ],
        [
          297301.77875068074,
          -66.56593247054724
        ],
        [
          299369.67615473265,
          -66.34286124866794
        ],
        [
          301451.9569226906,
          -66.1195711332754
        ],
        [
          303548.72109876224,
          -65.89605884434081
        ],
        [
          305660.0694230177,
          -65.67232104943388
        ],
        [
          307786.10333622963,
          -65.44835436279227
        ],
        [
          309926.92498474725,
          -65.22415534437208
        ],
        [
          312082.6372254036,
          -64.9997204988785
        ],
        [
          314253.34363045776,
          -64.77504627477659
        ],
        [
          316439.1484925707,
          -64.55012906328135
        ],
        [
          318640.15682981623,
          -64.32496519732682
        ],
        [
          320856.47439072677,
          -64.0995509505136
        ],
        [
          323088.2076593738,
          -63.87388253603416
        ],
        [
          325335.4638604842,
          -63.64795610557561
        ],
        [
          327598.35096459166,
          -63.4217677481991
        ],
        [
          329876.97769322444,
          -63.195313489195605
        ],
        [
          332171.4535241288,
          -62.96858928891717
        ],
        [
          334481.888696529,
          -62.74159104158321
        ],
        [
          336808.39421642356,
          -62.51431457406113
        ],
        [
          339151.081861919,
          -62.28675564462078
        ],
        [
          341510.0641886,
          -62.05890994166186
        ],
        [
          343885.4545349371,
          -61.83077308241369
        ],
        [
          346277.36702773237,
          -61.60234061160676
        ],
        [
          348685.9165876026,
          -61.373608000115176
        ],
        [
          351111.21893450053,
          -61.14457064356917
        ],
        [
          353553.390593275,
          -60.91522386093742
        ],
        [
          356012.54889926926,
          -60.68556289307749
        ],
        [
          358488.8120039582,
          -60.4555829012547
        ],
        [
          360982.29888062546,
          -60.225278965627524
        ],
        [
          363493.12933007913,
          -59.99464608369945
        ],
        [
          366021.42398640787,
          -59.76367916873595
        ],
        [
          368567.30432277685,
          -59.532373048145864
        ],
        [
          371130.89265726384,
          -59.30072246182632
        ],
        [
          373712.3121587362,
          -59.06872206046994
        ],
        [
          376311.6868527685,
          -58.83636640383373
        ],
        [
          378929.14162760123,
          -58.6036499589683
        ],
        [
          381564.80224014155,
          -58.37056709840654
        ],
        [
          384218.7953220049,
          -58.13711209831082
        ],
        [
          386891.2483855993,
          -57.90327913657719
        ],
        [
          389582.2898302518,
          -57.66906229089585
        ],
        [
          392292.04894837725,
          -57.434455536766514
        ],
        [
          395020.65593169053,
          -57.199452745467674
        ],
        [
          397768.2418774613,
          -56.964047681978094
        ],
        [
          400534.93879481306,
          -56.72823400284982
        ],
        [
          403320.8796110652,
          -56.49200525403092
        ],
        [
          406126.19817811984,
          -56.2553548686371
        ],
        [
          408951.0292788927,
          -56.01827616467013
        ],
        [
          411795.50863378873,
          -55.78076234268256
        ],
        [
          414659.7729072231,
          -55.542806483386364
        ],
        [
          417543.95971418696,
          -55.304401545204726
        ],
        [
          420448.2076268596,
          -55.06554036176497
        ],
        [
          423372.65618126595,
          -54.8262156393314
        ],
        [
          426317.4458839808,
          -54.58641995417618
        ],
        [
          429282.71821887937,
          -54.34614574988666
        ],
        [
          432268.6156539351,
          -54.10538533460762
        ],
        [
          435275.2816480647,
          -53.8641308782164
        ],
        [
          438302.8606580202,
          -53.62237440942945
        ],
        [
          441351.4981453301,
          -53.38010781283812
        ],
        [
          444421.3405832878,
          -53.13732282587214
        ],
        [
          447512.535463989,
          -52.89401103568878
        ],
        [
          450625.23130541795,
          -52.65016387598549
        ],
        [
          453759.5776585833,
          -52.40577262373451
        ],
        [
          456915.7251147032,
          -52.160828395836845
        ],
        [
          460093.8253124405,
          -51.915322145694056
        ],
        [
          463294.0309451885,
          -51.66924465969526
        ],
        [
          466516.49576840684,
          -51.422586553617606
        ],
        [
          469761.37460700906,
          -51.17533826893766
        ],
        [
          473028.82336280117,
          -50.92749006905177
        ],
        [
          476318.99902197195,
          -50.67903203540296
        ],
        [
          479632.0596626355,
          -50.42995406351199
        ],
        [
          482968.16446242615,
          -50.18024585891055
        ],
        [
          486327.4737061462,
          -49.92989693297399
        ],
        [
          489710.1487934669,
          -49.678896598651214
        ],
        [
          493116.35224668315,
          -49.42723396608959
        ],
        [
          496546.24771852157,
          -49.17489793815221
        ],
        [
          500000.00000000367,
          -48.92187720582535
        ],
        [
          503477.77502836316,
          -48.66816024351364
        ],
        [
          506979.7398950184,
          -48.41373530422053
        ],
        [
          510506.06285360054,
          -48.15859041461194
        ],
        [
          514056.91332803725,
          -47.90271336996068
        ],
        [
          517632.4619206928,
          -47.646091728969246
        ],
        [
          521232.88042056485,
          -47.38871280846918
        ],
        [
          524858.3418115379,
          -47.130563677994715
        ],
        [
          528509.0202806945,
          -46.87163115422875
        ],
        [
          532185.0912266843,
          -46.61190179531925
        ],
        [
          535886.731268151,
          -46.351361895064755
        ],
        [
          539614.118252218,
          -46.08999747696696
        ],
        [
          543367.4312630335,
          -45.82779428814952
        ],
        [
          547146.8506303743,
          -45.56473779314188
        ],
        [
          550952.55793831,
          -45.300813167527345
        ],
        [
          554784.7360339272,
          -45.03600529145512
        ],
        [
          558643.5690361147,
          -44.770298743016134
        ],
        [
          562529.2423444095,
          -44.503677791483256
        ],
        [
          566441.9426479042,
          -44.23612639041657
        ],
        [
          570381.8579342167,
          -43.9676281706355
        ],
        [
          574349.1774985224,
          -43.69816643305968
        ],
        [
          578344.0919526487,
          -43.427724141421606
        ],
        [
          582366.793234233,
          -43.156283914854654
        ],
        [
          586417.4746159447,
          -42.88382802036142
        ],
        [
          590496.3307147706,
          -42.61033836516767
        ],
        [
          594603.557501366,
          -42.33579648896939
        ],
        [
          598739.3523094698,
          -42.06018355608083
        ],
        [
          602903.9138453858,
          -41.78348034749362
        ],
        [
          607097.4421975291,
          -41.50566725285859
        ],
        [
          611320.13884604,
          -41.226724262403714
        ],
        [
          615572.206672464,
          -40.94663095880399
        ],
        [
          619853.8499694993,
          -40.66536650902165
        ],
        [
          624165.274450812,
          -40.38290965613729
        ],
        [
          628506.6872609203,
          -40.0992387111965
        ],
        [
          632878.2969851462,
          -39.81433154509935
        ],
        [
          637280.3136596375,
          -39.52816558056428
        ],
        [
          641712.9487814585,
          -39.2407177842026
        ],
        [
          646176.4153187526,
          -38.951964658744174
        ],
        [
          650670.9277209734,
          -38.6618822354611
        ],
        [
          655196.7019291883,
          -38.370446066842035
        ],
        [
          659753.9553864539,
          -38.07763121957686
        ],
        [
          664342.9070482627,
          -37.78341226791935
        ],
        [
          668963.777393063,
          -37.48776328750447
        ],
        [
          673616.7884328521,
          -37.190657849706426
        ],
        [
          678302.163723843,
          -36.892069016635276
        ],
        [
          683020.128377205,
          -36.59196933688201
        ],
        [
          687770.9090698792,
          -36.290330842136214
        ],
        [
          692554.7340554699,
          -35.987125044816295
        ],
        [
          697371.8331752103,
          -35.682322936869774
        ],
        [
          702222.4378690063,
          -35.37589498992132
        ],
        [
          707106.7811865554,
          -35.06781115696826
        ],
        [
          712025.0977985439,
          -34.75804087584902
        ],
        [
          716977.6240079218,
          -34.44655307473742
        ],
        [
          721964.5977612563,
          -34.13331617994855
        ],
        [
          726986.2586601636,
          -33.81829812637665
        ],
        [
          732042.8479728212,
          -33.501466370926686
        ],
        [
          737134.6086455592,
          -33.18278790934577
        ],
        [
          742261.7853145333,
          -32.86222929691186
        ],
        [
          747424.624317478,
          -32.53975667349432
        ],
        [
          752623.3737055425,
          -32.215335793565394
        ],
        [
          757858.283255208,
          -31.88893206181404
        ],
        [
          763129.6044802887,
          -31.560510575095083
        ],
        [
          768437.5906440155,
          -31.230036171538465
        ],
        [
          773782.4967712044,
          -30.89747348774605
        ],
        [
          779164.5796605095,
          -30.562787025119952
        ],
        [
          784584.0978967604,
          -30.225941226495916
        ],
        [
          790041.311863387,
          -29.88690056440204
        ],
        [
          795536.4837549287,
          -29.5456296424269
        ],
        [
          801069.8775896322,
          -29.202093311365545
        ],
        [
          806641.7592221366,
          -28.856256802017903
        ],
        [
          812252.396356246,
          -28.508085876745383
        ],
        [
          817902.0585577918,
          -28.157547002148917
        ],
        [
          823591.0172675839,
          -27.804607545520376
        ],
        [
          829319.5458144526,
          -27.44923599803933
        ],
        [
          835087.9194283803,
          -27.091402228043883
        ],
        [
          840896.4152537256,
          -26.731077768098324
        ],
        [
          846745.3123625383,
          -26.36823614001667
        ],
        [
          852634.891767968,
          -26.00285322247952
        ],
        [
          858565.4364377651,
          -25.63490766640593
        ],
        [
          864537.2313078768,
          -25.264381363811932
        ],
        [
          870550.5632961359,
          -24.891259976501733
        ],
        [
          876605.721316047,
          -24.515533531596173
        ],
        [
          882702.996290667,
          -24.137197091597585
        ],
        [
          888842.6811665825,
          -23.756251507414902
        ],
        [
          895025.0709279849,
          -23.372704263512354
        ],
        [
          901250.4626108429,
          -22.986570425079854
        ],
        [
          907519.1553171737,
          -22.597873697825975
        ],
        [
          913831.4502294136,
          -22.206647611625797
        ],
        [
          920187.6506248883,
          -21.81293683976437
        ],
        [
          926588.0618903842,
          -21.416798665833365
        ],
        [
          933032.9915368209,
          -21.01830461037512
        ],
        [
          939522.7492140254,
          -20.617542229009217
        ],
        [
          946057.6467256098,
          -20.214617092879386
        ],
        [
          952637.9980439515,
          -19.809654960641804
        ],
        [
          959264.1193252787,
          -19.402804148662362
        ],
        [
          965936.32892486,
          -18.99423810233452
        ],
        [
          972654.9474123002,
          -18.584158166163245
        ],
        [
          979420.2975869417,
          -18.172796543127617
        ],
        [
          986232.7044933742,
          -17.76041942444219
        ],
        [
          993092.4954370512,
          -17.347330258768284
        ],
        [
          1000000.0000000155,
          -16.933873114765674
        ],
        [
          1006955.5500567345,
          -16.5204360722567
        ],
        [
          1013959.479790045,
          -16.107454554938293
        ],
        [
          1021012.1257072092,
          -15.69541449146534
        ],
        [
          1028113.8266560826,
          -15.284855162096829
        ],
        [
          1035264.9238413938,
          -14.876371555667534
        ],
        [
          1042465.7608411378,
          -14.47061602777426
        ],
        [
          1049716.6836230839,
          -14.06829901791862
        ],
        [
          1057018.040561397,
          -13.670188554067206
        ],
        [
          1064370.1824533767,
          -13.277108251896754
        ],
        [
          1071773.46253631,
          -12.889933508158343
        ],
        [
          1079228.2365044444,
          -12.509585599236681
        ],
        [
          1086734.8625260754,
          -12.13702343356095
        ],
        [
          1094293.7012607572,
          -11.77323277603249
        ],
        [
          1101905.1158766286,
          -11.419212868411483
        ],
        [
          1109569.472067863,
          -11.075960512878604
        ],
        [
          1117287.138072238,
          -10.744451863339819
        ],
        [
          1125058.4846888278,
          -10.425622371082678
        ],
        [
          1132883.8852958172,
          -10.120345542136068
        ],
        [
          1140763.7158684423,
          -9.829411361046347
        ],
        [
          1148698.354997054,
          -9.553505393578648
        ],
        [
          1156688.1839053067,
          -9.293189672341068
        ],
        [
          1164733.5864684754,
          -9.048886471926782
        ],
        [
          1172834.9492318986,
          -8.82086598045157
        ],
        [
          1180992.6614295505,
          -8.609238672162384
        ],
        [
          1189207.1150027413,
          -8.41395289612073
        ],
        [
          1197478.7046189492,
          -8.234797847930503
        ],
        [
          1205807.827690781,
          -8.071411724078
        ],
        [
          1214194.8843950678,
          -7.923294514035262
        ],
        [
          1222640.2776920898,
          -7.7898246022188395
        ],
        [
          1231144.4133449378,
          -7.670278158206893
        ],
        [
          1239707.6999390083,
          -7.56385020299362
        ],
        [
          1248330.548901634,
          -7.4696762500717915
        ],
        [
          1257013.3745218508,
          -7.3868535183820665
        ],
        [
          1265756.5939703027,
          -7.314460876506772
        ],
        [
          1274560.6273192852,
          -7.251576877054142
        ],
        [
          1283425.8975629276,
          -7.19729545102985
        ],
        [
          1292352.830637516,
          -7.150739032519963
        ],
        [
          1301341.8554419575,
          -7.111069058799435
        ],
        [
          1310393.4038583874,
          -7.077493931205981
        ],
        [
          1319507.9107729187,
          -7.049274624823632
        ],
        [
          1328685.8140965363,
          -7.025728201768729
        ],
        [
          1337927.554786137,
          -7.006229518204693
        ],
        [
          1347233.5768657154,
          -6.990211425204002
        ],
        [
          1356604.3274476973,
          -6.977163754691526
        ],
        [
          1366040.2567544212,
          -6.966631359998545
        ],
        [
          1375541.8181397696,
          -6.958211451220965
        ],
        [
          1385109.468110951,
          -6.951550432730071
        ],
        [
          1394743.666350432,
          -6.946340416881359
        ],
        [
          1404444.875738024,
          -6.9423155562926855
        ],
        [
          1414213.5623731222,
          -6.939248308303787
        ],
        [
          1424050.1955970991,
          -6.936945720053452
        ],
        [
          1433955.248015855,
          -6.9352458012324005
        ],
        [
          1443929.195522524,
          -6.93401403389943
        ],
        [
          1453972.5173203386,
          -6.933140054503141
        ],
        [
          1464085.6959456538,
          -6.932534532044726
        ],
        [
          1474269.21729113,
          -6.9321262577213005
        ],
        [
          1484523.5706290782,
          -6.931859454975139
        ],
        [
          1494849.2486349677,
          -6.931691314239641
        ],
        [
          1505246.747411097,
          -6.9315897534561834
        ],
        [
          1515716.5665104282,
          -6.93153140332244
        ],
        [
          1526259.2089605895,
          -6.931499814957158
        ],
        [
          1536875.181288043,
          -6.931483887008864
        ],
        [
          1547564.993542421,
          -6.931476509021691
        ],
        [
          1558329.159321031,
          -6.9314734179619775
        ],
        [
          1569168.1957935332,
          -6.931472265100439
        ],
        [
          1580082.6237267863,
          -6.931471890860194
        ],
        [
          1591072.9675098697,
          -6.9314718057272
        ],
        [
          1602139.755179277,
          -6.931471875842922
        ],
        [
          1613283.5184442857,
          -6.931472212437837
        ],
        [
          1624504.7927125045,
          -6.931473264809184
        ],
        [
          1635804.117115596,
          -6.9314761170924815
        ],
        [
          1647182.0345351805,
          -6.931482989621049
        ],
        [
          1658639.091628918,
          -6.931497946207869
        ],
        [
          1670175.8388567737,
          -6.931527809208827
        ],
        [
          1681792.8305074645,
          -6.931583284717444
        ],
        [
          1693490.62472509,
          -6.931680300664272
        ],
        [
          1705269.7835359497,
          -6.931841560898814
        ],
        [
          1717130.8728755442,
          -6.9320983184434235
        ],
        [
          1729074.4626157675,
          -6.9324923709252495
        ],
        [
          1741101.1265922857,
          -6.933078280579878
        ],
        [
          1753211.442632108,
          -6.933925820005794
        ],
        [
          1765405.992581348,
          -6.935122642817527
        ],
        [
          1777685.362333179,
          -6.936777175235714
        ],
        [
          1790050.1418559838,
          -6.9390217201538285
        ],
        [
          1802500.9252216998,
          -6.942015758976368
        ],
        [
          1815038.3106343613,
          -6.945949428132475
        ],
        [
          1827662.9004588411,
          -6.95104713620483
        ],
        [
          1840375.3012497907,
          -6.95757127364701
        ],
        [
          1853176.1237807828,
          -6.965825949701302
        ],
        [
          1866065.9830736562,
          -6.976160670077808
        ],
        [
          1879045.4984280653,
          -6.988973844105056
        ],
        [
          1892115.293451234,
          -7.004715981593602
        ],
        [
          1905275.9960879174,
          -7.023892408191394
        ],
        [
          1918528.2386505718,
          -7.047065294777292
        ],
        [
          1931872.6578497346,
          -7.074854763449454
        ],
        [
          1945309.894824615,
          -7.107938802878554
        ],
        [
          1958840.5951738982,
          -7.147051703242225
        ],
        [
          1972465.408986763,
          -7.192980710735619
        ],
        [
          1986184.990874117,
          -7.246560609761245
        ],
        [
          2000000.0000000456,
          -7.308665973792683
        ],
        [
          2013911.1001134836,
          -7.380200889731531
        ],
        [
          2027918.9595801048,
          -7.462086060059688
        ],
        [
          2042024.2514144336,
          -7.55524332411512
        ],
        [
          2056227.6533121807,
          -7.6605778118803345
        ],
        [
          2070529.8476828032,
          -7.778958142489402
        ],
        [
          2084931.5216822915,
          -7.911195290390896
        ],
        [
          2099433.3672461836,
          -8.058020943628016
        ],
        [
          2114036.0811228105,
          -8.220066345328679
        ],
        [
          2128740.36490677,
          -8.397842714284739
        ],
        [
          2143546.9250726374,
          -8.591724359773822
        ],
        [
          2158456.473008906,
          -8.80193552419824
        ],
        [
          2173469.725052168,
          -9.028541802009673
        ],
        [
          2188587.4025215316,
          -9.271446707130742
        ],
        [
          2203810.2317532743,
          -9.5303936205643
        ],
        [
          2219138.9441357437,
          -9.804972982800633
        ],
        [
          2234574.2761444943,
          -10.094634244289239
        ],
        [
          2250116.9693776737,
          -10.398701791200537
        ],
        [
          2265767.7705916525,
          -10.716393853134033
        ],
        [
          2281527.4317369033,
          -11.046843290652577
        ],
        [
          2297396.7099941266,
          -11.389119154644083
        ],
        [
          2313376.367810632,
          -11.742247994115997
        ],
        [
          2329467.1729369694,
          -12.10523404212443
        ],
        [
          2345669.898463816,
          -12.477077604553635
        ],
        [
          2361985.3228591196,
          -12.856791186996073
        ],
        [
          2378414.230005502,
          -13.243413098502304
        ],
        [
          2394957.4092379175,
          -13.636018450916156
        ],
        [
          2411615.6553815817,
          -14.033727618943212
        ],
        [
          2428389.768790155,
          -14.435712335122888
        ],
        [
          2445280.555384199,
          -14.84119966637997
        ],
        [
          2462288.8266898952,
          -15.249474158948244
        ],
        [
          2479415.399878036,
          -15.659878452086684
        ],
        [
          2496661.0978032877,
          -16.071812654607545
        ],
        [
          2514026.7490437212,
          -16.484732757973532
        ],
        [
          2531513.187940625,
          -16.89814833095784
        ],
        [
          2549121.25463859,
          -17.311619707907433
        ],
        [
          2566851.7951258747,
          -17.72475484874199
        ],
        [
          2584705.6612750515,
          -18.13720601620206
        ],
        [
          2602683.710883935,
          -18.548666385951307
        ],
        [
          2620786.8077167952,
          -18.958866678705117
        ],
        [
          2639015.821545858,
          -19.367571880894175
        ],
        [
          2657371.6281930935,
          -19.774578101439857
        ],
        [
          2675855.109572295,
          -20.179709596772142
        ],
        [
          2694467.1537314523,
          -20.58281598390147
        ],
        [
          2713208.6548954165,
          -20.983769651747703
        ],
        [
          2732080.513508864,
          -21.382463373618425
        ],
        [
          2751083.6362795616,
          -21.778808118315226
        ],
        [
          2770218.936221924,
          -22.172731053473438
        ],
        [
          2789487.3327008863,
          -22.56417373209452
        ],
        [
          2808889.7514760704,
          -22.953090451541453
        ],
        [
          2828427.1247462668,
          -23.33944677331624
        ],
        [
          2848100.391194221,
          -23.723218191538958
        ],
        [
          2867910.496031733,
          -24.104388938054583
        ],
        [
          2887858.3910450717,
          -24.482950912391516
        ],
        [
          2907945.0346407015,
          -24.858902725289305
        ],
        [
          2928171.391891332,
          -25.232248845137008
        ],
        [
          2948538.434582284,
          -25.602998837361483
        ],
        [
          2969047.1412581806,
          -25.971166687538215
        ],
        [
          2989698.49726996,
          -26.336770199737597
        ],
        [
          3010493.4948222185,
          -26.699830462345382
        ],
        [
          3031433.133020881,
          -27.06037137429478
        ],
        [
          3052518.417921204,
          -27.41841922530831
        ],
        [
          3073750.362576111,
          -27.7740023243668
        ],
        [
          3095129.987084867,
          -28.12715067119624
        ],
        [
          3116658.3186420873,
          -28.477895666091687
        ],
        [
          3138336.3915870916,
          -28.826269853879538
        ],
        [
          3160165.2474535983,
          -29.172306698259185
        ],
        [
          3182145.935019765,
          -29.516040383163254
        ],
        [
          3204279.5103585795,
          -29.857505638134626
        ],
        [
          3226567.036888597,
          -30.196737585042275
        ],
        [
          3249009.5854250346,
          -30.53377160374891
        ],
        [
          3271608.2342312178,
          -30.868643214603434
        ],
        [
          3294364.0690703867,
          -31.201387975864662
        ],
        [
          3317278.183257862,
          -31.5320413943712
        ],
        [
          3340351.6777135734,
          -31.860638847957993
        ],
        [
          3363585.661014955,
          -32.187215518285996
        ],
        [
          3386981.2494502063,
          -32.511806332899425
        ],
        [
          3410539.5670719254,
          -32.834445915456016
        ],
        [
          3434261.7457511146,
          -33.15516854319311
        ],
        [
          3458148.925231561,
          -33.474008110796774
        ],
        [
          3482202.253184598,
          -33.79099809993312
        ],
        [
          3506422.8852642425,
          -34.10617155378378
        ],
        [
          3530811.9851627224,
          -34.41956105600069
        ],
        [
          3555370.7246663845,
          -34.73119871356034
        ],
        [
          3580100.2837119945,
          -35.041116143055184
        ],
        [
          3605001.850443427,
          -35.349344460011785
        ],
        [
          3630076.6212687506,
          -35.65591427087112
        ],
        [
          3655325.80091771,
          -35.96085566730599
        ],
        [
          3680750.6024996093,
          -36.26419822258819
        ],
        [
          3706352.2475615935,
          -36.56597098974905
        ],
        [
          3732131.966147341,
          -36.866202501305835
        ],
        [
          3758090.9968561595,
          -37.16492077035251
        ],
        [
          3784230.5869024973,
          -37.462153292834756
        ],
        [
          3810551.9921758645,
          -37.75792705085068
        ],
        [
          3837056.477301174,
          -38.05226851683541
        ],
        [
          3863745.3156994996,
          -38.345203658504396
        ],
        [
          3890619.7896492607,
          -38.63675794444419
        ],
        [
          3917681.190347827,
          -38.926956350251984
        ],
        [
          3944930.8179735574,
          -39.21582336513684
        ],
        [
          3972369.981748265,
          -39.50338299890515
        ],
        [
          4000000.000000123,
          -39.78965878926193
        ],
        [
          4027822.2002269994,
          -40.074673809367724
        ],
        [
          4055837.9191602417,
          -40.35845067559765
        ],
        [
          4084048.5028288993,
          -40.64101155545562
        ],
        [
          4112455.3066243934,
          -40.92237817560233
        ],
        [
          4141059.6953656385,
          -41.20257182996066
        ],
        [
          4169863.043364615,
          -41.481613387866496
        ],
        [
          4198866.7344924,
          -41.75952330223727
        ],
        [
          4228072.162245654,
          -42.036321617733314
        ],
        [
          4257480.729813573,
          -42.31202797889142
        ],
        [
          4287093.850145307,
          -42.58666163821162
        ],
        [
          4316912.946017845,
          -42.86024146418157
        ],
        [
          4346939.45010437,
          -43.13278594922445
        ],
        [
          4377174.805043097,
          -43.40431321755904
        ],
        [
          4407620.463506582,
          -43.674841032961666
        ],
        [
          4438277.888271521,
          -43.94438680642172
        ],
        [
          4469148.552289022,
          -44.212967603683396
        ],
        [
          4500233.938755381,
          -44.48060015266833
        ],
        [
          4531535.541183339,
          -44.74730085077376
        ],
        [
          4563054.863473841,
          -45.01308577204291
        ],
        [
          4594793.419988288,
          -45.27797067420429
        ],
        [
          4626752.735621299,
          -45.54197100557801
        ],
        [
          4658934.345873973,
          -45.80510191184728
        ],
        [
          4691339.796927666,
          -46.06737824269422
        ],
        [
          4723970.645718274,
          -46.32881455829974
        ],
        [
          4756828.460011038,
          -46.58942513570709
        ],
        [
          4789914.8184758695,
          -46.84922397504984
        ],
        [
          4823231.310763198,
          -47.108224805644625
        ],
        [
          4856779.537580345,
          -47.366441091950016
        ],
        [
          4890561.110768433,
          -47.62388603939265
        ],
        [
          4924577.653379825,
          -47.88057260006187
        ],
        [
          4958830.799756108,
          -48.136513478274914
        ],
        [
          4993322.195606611,
          -48.3917211360143
        ],
        [
          5028053.498087478,
          -48.646207798239196
        ],
        [
          5063026.375881285,
          -48.89998545807323
        ],
        [
          5098242.509277215,
          -49.153065881870425
        ],
        [
          5133703.590251785,
          -49.40546061416181
        ],
        [
          5169411.322550138,
          -49.65718098248501
        ],
        [
          5205367.421767905,
          -49.908238102098764
        ],
        [
          5241573.615433626,
          -50.15864288058516
        ],
        [
          5278031.643091751,
          -50.40840602234184
        ],
        [
          5314743.256386222,
          -50.657538032966
        ],
        [
          5351710.219144626,
          -50.906049223533884
        ],
        [
          5388934.30746294,
          -51.1539497147765
        ],
        [
          5426417.309790868,
          -51.40124944115527
        ],
        [
          5464161.027017765,
          -51.64795815483914
        ],
        [
          5502167.272559159,
          -51.89408542958592
        ],
        [
          5540437.872443886,
          -52.13964066453002
        ],
        [
          5578974.66540181,
          -52.384633087878626
        ],
        [
          5617779.502952179,
          -52.62907176051917
        ],
        [
          5656854.249492572,
          -52.872965579539255
        ],
        [
          5696200.78238848,
          -53.11632328166247
        ],
        [
          5735820.992063505,
          -53.359153446601404
        ],
        [
          5775716.7820901815,
          -53.60146450032982
        ],
        [
          5815890.069281441,
          -53.84326471827649
        ],
        [
          5856342.783782703,
          -54.084562228443005
        ],
        [
          5897076.8691646075,
          -54.32536501444634
        ],
        [
          5938094.282516401,
          -54.565680918489285
        ],
        [
          5979396.99453996,
          -54.8055176442599
        ],
        [
          6020986.989644477,
          -55.04488275976242
        ],
        [
          6062866.266041802,
          -55.28378370008057
        ],
        [
          6105036.835842448,
          -55.522227770075716
        ],
        [
          6147500.725152263,
          -55.76022214702172
        ],
        [
          6190259.974169776,
          -55.997773883177075
        ],
        [
          6233316.637284217,
          -56.23488990829726
        ],
        [
          6276672.783174226,
          -56.47157703208792
        ],
        [
          6320330.494907239,
          -56.70784194660123
        ],
        [
          6364291.870039574,
          -56.9436912285756
        ],
        [
          6408559.020717204,
          -57.179131341722346
        ],
        [
          6453134.07377724,
          -57.41416863895811
        ],
        [
          6498019.170850116,
          -57.64880936458674
        ],
        [
          6543216.468462483,
          -57.8830596564307
        ],
        [
          6588728.138140821,
          -58.11692554791342
        ],
        [
          6634556.3665157715,
          -58.350412970094254
        ],
        [
          6680703.355427195,
          -58.583527753657066
        ],
        [
          6727171.322029959,
          -58.81627563085364
        ],
        [
          6773962.498900463,
          -59.048662237403036
        ],
        [
          6821079.134143902,
          -59.28069311434825
        ],
        [
          6868523.49150228,
          -59.51237370987108
        ],
        [
          6916297.850463174,
          -59.74370938106618
        ],
        [
          6964404.506369248,
          -59.97470539567574
        ],
        [
          7012845.770528538,
          -60.20536693378547
        ],
        [
          7061623.970325499,
          -60.43569908948294
        ],
        [
          7110741.449332824,
          -60.66570687247932
        ],
        [
          7160200.567424044,
          -60.8953952096952
        ],
        [
          7210003.700886909,
          -61.12476894681229
        ],
        [
          7260153.242537556,
          -61.3538328497902
        ],
        [
          7310651.601835476,
          -61.582591606350874
        ],
        [
          7361501.204999275,
          -61.811049827430715
        ],
        [
          7412704.495123243,
          -62.03921204860094
        ],
        [
          7464263.932294738,
          -62.26708273145778
        ],
        [
          7516181.993712375,
          -62.49466626498263
        ],
        [
          7568461.173805051,
          -62.721966966872415
        ],
        [
          7621103.984351785,
          -62.94898908484316
        ],
        [
          7674112.954602404,
          -63.175736797904264
        ],
        [
          7727490.631399055,
          -63.402214217606456
        ],
        [
          7781239.579298577,
          -63.62842538926379
        ],
        [
          7835362.380695711,
          -63.854374293148936
        ],
        [
          7889861.635947172,
          -64.08006484566462
        ],
        [
          7944739.963496588,
          -64.30550090048963
        ],
        [
          8000000.000000304,
          -64.53068624970146
        ],
        [
          8055644.400454056,
          -64.75562462487571
        ],
        [
          8111675.838320542,
          -64.98031969816248
        ],
        [
          8168097.005657858,
          -65.20477508334062
        ],
        [
          8224910.613248847,
          -65.42899433685122
        ],
        [
          8282119.390731338,
          -65.6529809588083
        ],
        [
          8339726.086729293,
          -65.87673839399082
        ],
        [
          8397733.468984863,
          -66.10027003281253
        ],
        [
          8456144.32449137,
          -66.32357921227451
        ],
        [
          8514961.45962721,
          -66.54666921689633
        ],
        [
          8574187.700290678,
          -66.76954327962999
        ],
        [
          8633825.892035753,
          -66.99220458275465
        ],
        [
          8693878.900208803,
          -67.21465625875426
        ],
        [
          8754349.610086257,
          -67.43690139117702
        ],
        [
          8815240.92701323,
          -67.65894301547866
        ],
        [
          8876555.776543107,
          -67.88078411984796
        ],
        [
          8938297.10457811,
          -68.10242764601719
        ],
        [
          9000467.877510829,
          -68.32387649005545
        ],
        [
          9063071.082366746,
          -68.5451335031482
        ],
        [
          9126109.726947749,
          -68.76620149235916
        ],
        [
          9189586.839976642,
          -68.98708322138032
        ],
        [
          9253505.471242664,
          -69.20778141126439
        ],
        [
          9317868.691748016,
          -69.42829874114607
        ],
        [
          9382679.593855403,
          -69.64863784894696
        ],
        [
          9447941.29143662,
          -69.86880133206861
        ],
        [
          9513656.920022149,
          -70.08879174807171
        ],
        [
          9579829.636951813,
          -70.30861161534209
        ],
        [
          9646462.62152647,
          -70.52826341374461
        ],
        [
          9713559.075160766,
          -70.7477495852645
        ],
        [
          9781122.221536942,
          -70.96707253463626
        ],
        [
          9849155.306759728,
          -71.1862346299615
        ],
        [
          9917661.599512294,
          -71.40523820331407
        ],
        [
          9986644.3912133,
          -71.62408555133501
        ]
      ],
      "zlevel": 0,
      "z": 2,
      "silent": false
    }]
};
      chart_8373210d0bab4f099548c1ba613d988f.setOption(option_8373210d0bab4f099548c1ba613d988f);
    </script>
  </body>
</html>
</p>
<p class='ruff'>We define pass bandwidth by edge values -10dB, to find them we use next procedure:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#fe6efe>proc</font></b> findBW {freqs vals trigVal} {
    <i><font color=#76a396># calculate bandwidth of results</font></i>
    <b><font color=#ffa500>set</font></b> freqsLen [<b><font color=#ffa500>llength</font></b> <font color=#f1b479>$freqs</font>]
    <b><font color=#ffa500>for</font></b> {<b><font color=#ffa500>set</font></b> i 0} {<font color=#f1b479>$i</font>&lt;<font color=#f1b479>$freqsLen</font>} {<b><font color=#ffa500>incr</font></b> i} {
        <b><font color=#ffa500>set</font></b> iVal [@ <font color=#f1b479>$vals</font> <font color=#f1b479>$i</font>]
        <b><font color=#ffa500>set</font></b> ip1Val [@ <font color=#f1b479>$vals</font> [+ <font color=#f1b479>$i</font> 1]]
        <b><font color=#ffa500>if</font></b> {(<font color=#f1b479>$iVal</font>&lt;=<font color=#f1b479>$trigVal</font>) && (<font color=#f1b479>$ip1Val</font>&gt;=<font color=#f1b479>$trigVal</font>)} {
            <b><font color=#ffa500>set</font></b> freqStart [@ <font color=#f1b479>$freqs</font> <font color=#f1b479>$i</font>]
        } <b><font color=#ffa500>elseif</font></b> {(<font color=#f1b479>$iVal</font>&gt;=<font color=#f1b479>$trigVal</font>) && (<font color=#f1b479>$ip1Val</font>&lt;=<font color=#f1b479>$trigVal</font>)} {
            <b><font color=#ffa500>set</font></b> freqEnd [@ <font color=#f1b479>$freqs</font> <font color=#f1b479>$i</font>]
        }
    }
    <b><font color=#ffa500>set</font></b> bw [= {<font color=#f1b479>$freqEnd</font>-<font color=#f1b479>$freqStart</font>}]
    <b><font color=#fe6efe>return</font></b> <font color=#f1b479>$bw</font>
}
</pre>

</figure><p class='ruff'>Find bandwidth:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>puts</font></b> [findBW [<b><font color=#ffa500>lmap</font></b> freq <font color=#f1b479>$freqs</font> {@ <font color=#f1b479>$freq</font> 0}] <font color=#f1b479>$trace</font> -10]
</pre>

</figure><p class='ruff'>The value is 1.086255 Mhz.</p>
<p class='ruff'>Our goal is to obtain a distribution of bandwidths by varying the filter parameters. To generate random values for these parameters, we use the built-in functions of the <code>math::statistics</code> package from Tcllib. The parameters can be distributed either normally or uniformly. For uniform distribution, we use <code>::math::statistics::random-uniform xmin xmax number</code>; for normal distribution, we use <code>::math::statistics::random-normal mean stdev number</code>. For uniform distribution, we define the following min and max limits for each C and L element:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> distLimits [<b><font color=#ffa500>dcreate</font></b> c1 [<b><font color=#ffa500>dcreate</font></b> min 0.9e-9 max 1.1e-9] l1 [<b><font color=#ffa500>dcreate</font></b> min 9e-6 max 11e-6] c2 [<b><font color=#ffa500>dcreate</font></b> min 0.9e-9 max 1.1e-9] l2 [<b><font color=#ffa500>dcreate</font></b> min 9e-6 max 11e-6] c3 [<b><font color=#ffa500>dcreate</font></b> min 225e-12 max 275e-12] l3 [<b><font color=#ffa500>dcreate</font></b> min 36e-6 max 44e-6]]
</pre>

</figure><p class='ruff'>We can specify different numbers of simulations; the more runs we perform, the more accurate the representation becomes. For example, we set the number of simulations to 1,000 runs with 15 intervals for constructing a boxplot:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><i><font color=#76a396># set number of simulations</font></i>
<b><font color=#ffa500>set</font></b> mcRuns 100
<b><font color=#ffa500>set</font></b> numOfIntervals 15
</pre>

</figure><p class='ruff'>Now we ready to run simulations 1000 times and collect results:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><i><font color=#76a396># loop in which we run simulation with uniform distribution</font></i>
<b><font color=#ffa500>for</font></b> {<b><font color=#ffa500>set</font></b> i 0} {<font color=#f1b479>$i</font>&lt;<font color=#f1b479>$mcRuns</font>} {<b><font color=#ffa500>incr</font></b> i} {
    <i><font color=#76a396>#set elements values according to uniform distribution</font></i>
    <b><font color=#ffa500>foreach</font></b> elem [<b><font color=#ffa500>list</font></b> c1 l1 c2 l2 c3 l3] {
        <font color=#f1b479>$elem</font> setParamValue [<b><font color=#ffa500>string</font></b> index <font color=#f1b479>$elem</font> 0] [random-uniform {<b><font color=#ffa500>*</font></b>}[<b><font color=#ffa500>dict</font></b> values [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$distLimits</font> <font color=#f1b479>$elem</font>]] 1]
    }
    <i><font color=#76a396># run simulation</font></i>
    <font color=#f1b479>$circuit</font> runAndRead
    <i><font color=#76a396># get data dictionary</font></i>
    <b><font color=#ffa500>set</font></b> data [<font color=#f1b479>$circuit</font> getDataDict]
    <i><font color=#76a396># get results</font></i>
    <b><font color=#ffa500>if</font></b> {<font color=#f1b479>$i</font>==0} {
        <b><font color=#ffa500>set</font></b> freqs [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$data</font> frequency]
        <b><font color=#ffa500>foreach</font></b> freq <font color=#f1b479>$freqs</font> {
            <b><font color=#ffa500>lappend</font></b> freqRes [@ <font color=#f1b479>$freq</font> 0]
        }
    }
    <i><font color=#76a396># get vout frequency curve</font></i>
    <b><font color=#ffa500>lappend</font></b> traceListUni [calcDbMagVec [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$data</font> v(out)]]
    <i><font color=#76a396># calculate bandwidths values</font></i>
    <b><font color=#ffa500>lappend</font></b> bwsUni [findBW <font color=#f1b479>$freqRes</font> [@ <font color=#f1b479>$traceListUni</font> end] -10]
}
</pre>

</figure><p class='ruff'>To obtain the distribution, we need to determine reasonable limits based on the minimum and maximum of the generated bandwidth values. Using the specified number of intervals (15), we apply the following procedure:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#fe6efe>proc</font></b> createIntervals {data numOfIntervals} {
    <b><font color=#ffa500>set</font></b> intervals [::math::statistics::minmax-histogram-limits [tcl::mathfunc::min {<b><font color=#ffa500>*</font></b>}<font color=#f1b479>$data</font>]  [tcl::mathfunc::max {<b><font color=#ffa500>*</font></b>}<font color=#f1b479>$data</font>] <font color=#f1b479>$numOfIntervals</font>]
    <b><font color=#ffa500>lappend</font></b> intervalsStrings [<b><font color=#ffa500>format</font></b> <font color=#90ee90>&quot;&lt;=%.2e&quot;</font> [@ <font color=#f1b479>$intervals</font> 0]]
    <b><font color=#ffa500>for</font></b> {<b><font color=#ffa500>set</font></b> i 0} {<font color=#f1b479>$i</font>&lt;[- [<b><font color=#ffa500>llength</font></b> <font color=#f1b479>$intervals</font>] 1]} {<b><font color=#ffa500>incr</font></b> i} {
        <b><font color=#ffa500>lappend</font></b> intervalsStrings [<b><font color=#ffa500>format</font></b> <font color=#90ee90>&quot;%.2e-%.2e&quot;</font> [@ <font color=#f1b479>$intervals</font> <font color=#f1b479>$i</font>] [@ <font color=#f1b479>$intervals</font> [+ <font color=#f1b479>$i</font> 1]]]
    }
    <b><font color=#fe6efe>return</font></b> [<b><font color=#ffa500>dcreate</font></b> intervals <font color=#f1b479>$intervals</font> intervalsStr <font color=#f1b479>$intervalsStrings</font>]
}
</pre>

</figure><p class='ruff'>Here, we use the dedicated procedure from the statistics package: <code>::math::statistics::minmax-histogram-limits min max number</code>. Additionally, we construct strings in form <code>leftVal-rightVal</code> that represent the intervals on the boxplot chart. We call this procedure and store the results:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> uniIntervals [createIntervals <font color=#f1b479>$bwsUni</font> <font color=#f1b479>$numOfIntervals</font>]
</pre>

</figure><p class='ruff'>Finally, to obtain the expected histogram for a uniform distribution, we use the following procedure with the built-in function: <code>::math::statistics::histogram-uniform xmin xmax limits number</code>:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#fe6efe>proc</font></b> createDist {data intervals} {
    <b><font color=#ffa500>set</font></b> dist [::math::statistics::histogram <font color=#f1b479>$intervals</font> <font color=#f1b479>$data</font>]
    <b><font color=#fe6efe>return</font></b> [<b><font color=#ffa500>lrange</font></b> <font color=#f1b479>$dist</font> 0 end-1]
}
</pre>

</figure><p class='ruff'>Call the <code>createDist</code> procedure to calculate the histogram y-axis values, which correspond to the number of bandwidths within each interval:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> normDist [createDist <font color=#f1b479>$bwsNorm</font> [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$normIntervals</font> intervals]]
</pre>

</figure><p class='ruff'>The same sequence of steps is applied for the normal distribution. We assume that <code>std = (xmax - xmin) / 6</code>, where <code>xmax</code> and <code>xmin</code> are the limits of the uniform distribution.</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><i><font color=#76a396># set parameter's normal distributions limits</font></i>
<b><font color=#ffa500>set</font></b> normalLimits [<b><font color=#ffa500>dcreate</font></b> c1 [<b><font color=#ffa500>dcreate</font></b> mean 1e-9 std [/ 0.1e-9 3]] l1 [<b><font color=#ffa500>dcreate</font></b> mean 10e-6 std [/ 1e-6 3]] c2 [<b><font color=#ffa500>dcreate</font></b> mean 1e-9 std [/ 0.1e-9 3]] l2 [<b><font color=#ffa500>dcreate</font></b> mean 10e-6 std [/ 1e-6 3]] c3 [<b><font color=#ffa500>dcreate</font></b> mean 250e-12 std [/ 25e-12 3]] l3 [<b><font color=#ffa500>dcreate</font></b> mean 40e-6 std [/ 4e-6 3]]]

<i><font color=#76a396>## loop in which we run simulation with normal distribution</font></i>
<b><font color=#ffa500>for</font></b> {<b><font color=#ffa500>set</font></b> i 0} {<font color=#f1b479>$i</font>&lt;<font color=#f1b479>$mcRuns</font>} {<b><font color=#ffa500>incr</font></b> i} {
    <i><font color=#76a396>#set elements values according to normal distribution</font></i>
    <b><font color=#ffa500>foreach</font></b> elem [<b><font color=#ffa500>list</font></b> c1 l1 c2 l2 c3 l3] {
        <font color=#f1b479>$elem</font> setParamValue [<b><font color=#ffa500>string</font></b> index <font color=#f1b479>$elem</font> 0] [random-normal {<b><font color=#ffa500>*</font></b>}[<b><font color=#ffa500>dict</font></b> values [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$normalLimits</font> <font color=#f1b479>$elem</font>]] 1]
    }
    <i><font color=#76a396># run simulation</font></i>
    <font color=#f1b479>$circuit</font> runAndRead
    <i><font color=#76a396># get data dictionary</font></i>
    <b><font color=#ffa500>set</font></b> data [<font color=#f1b479>$circuit</font> getDataDict]
    <i><font color=#76a396># get results</font></i>
    <b><font color=#ffa500>if</font></b> {<font color=#f1b479>$i</font>==0} {
        <b><font color=#ffa500>set</font></b> freqs [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$data</font> frequency]
        <b><font color=#ffa500>foreach</font></b> freq <font color=#f1b479>$freqs</font> {
            <b><font color=#ffa500>lappend</font></b> freqRes [@ <font color=#f1b479>$freq</font> 0]
        }
    }
    <i><font color=#76a396># get vout frequency curve</font></i>
    <b><font color=#ffa500>lappend</font></b> traceListNorm [calcDbMagVec [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$data</font> v(out)]]
    <i><font color=#76a396># calculate bandwidths values</font></i>
    <b><font color=#ffa500>lappend</font></b> bwsNorm [findBW <font color=#f1b479>$freqRes</font> [@ <font color=#f1b479>$traceListNorm</font> end] -10]
}
<i><font color=#76a396># get distribution of bandwidths with normal parameters distribution</font></i>
<b><font color=#ffa500>set</font></b> normIntervals [createIntervals <font color=#f1b479>$bwsNorm</font> <font color=#f1b479>$numOfIntervals</font>]
<b><font color=#ffa500>set</font></b> normDist [createDist <font color=#f1b479>$bwsNorm</font> [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$normIntervals</font> intervals]]
</pre>

</figure><p class='ruff'>Finally, we plot resulted distributions:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><i><font color=#76a396># plot results with ticklecharts</font></i>
<i><font color=#76a396># chart for uniformly distributed parameters</font></i>
<b><font color=#ffa500>set</font></b> chartUni [ticklecharts::chart new]
<font color=#f1b479>$chartUni</font> Xaxis <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;Frequency intervals, Hz&quot;</font> <font color=#b9b96e>-data</font> [<b><font color=#ffa500>list</font></b> [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$uniIntervals</font> intervalsStr]] <font color=#b9b96e>-axisTick</font> {show <font color=#90ee90>&quot;True&quot;</font> alignWithLabel <font color=#90ee90>&quot;True&quot;</font>} <font color=#b9b96e>-axisLabel</font> {interval <font color=#90ee90>&quot;0&quot;</font> rotate <font color=#90ee90>&quot;45&quot;</font> fontSize <font color=#90ee90>&quot;8&quot;</font>}
<font color=#f1b479>$chartUni</font> Yaxis <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;Bandwidths per interval&quot;</font> <font color=#b9b96e>-minorTick</font> {show <font color=#90ee90>&quot;True&quot;</font>} <font color=#b9b96e>-type</font> <font color=#90ee90>&quot;value&quot;</font>
<font color=#f1b479>$chartUni</font> SetOptions <font color=#b9b96e>-title</font> {} <font color=#b9b96e>-tooltip</font> {trigger <font color=#90ee90>&quot;axis&quot;</font>} <font color=#b9b96e>-animation</font> <font color=#90ee90>&quot;False&quot;</font> <font color=#b9b96e>-toolbox</font> {feature {dataZoom {yAxisIndex <font color=#90ee90>&quot;none&quot;</font>}}} <font color=#b9b96e>-backgroundColor</font> <font color=#90ee90>&quot;#212121&quot;</font>
<font color=#f1b479>$chartUni</font> Add <font color=#90ee90>&quot;barSeries&quot;</font> <font color=#b9b96e>-data</font> [<b><font color=#ffa500>list</font></b> <font color=#f1b479>$uniDist</font>]
<i><font color=#76a396># chart for normally distributed parameters</font></i>
<b><font color=#ffa500>set</font></b> chartNorm [ticklecharts::chart new]
<font color=#f1b479>$chartNorm</font> Xaxis <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;Frequency intervals, Hz&quot;</font> <font color=#b9b96e>-data</font> [<b><font color=#ffa500>list</font></b> [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$normIntervals</font> intervalsStr]] <font color=#b9b96e>-axisTick</font> {show <font color=#90ee90>&quot;True&quot;</font> alignWithLabel <font color=#90ee90>&quot;True&quot;</font>} <font color=#b9b96e>-axisLabel</font> {interval <font color=#90ee90>&quot;0&quot;</font> rotate <font color=#90ee90>&quot;45&quot;</font> fontSize <font color=#90ee90>&quot;8&quot;</font>}
<font color=#f1b479>$chartNorm</font> Yaxis <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;Bandwidths per interval&quot;</font> <font color=#b9b96e>-minorTick</font> {show <font color=#90ee90>&quot;True&quot;</font>} <font color=#b9b96e>-type</font> <font color=#90ee90>&quot;value&quot;</font>
<font color=#f1b479>$chartNorm</font> SetOptions <font color=#b9b96e>-title</font> {} <font color=#b9b96e>-tooltip</font> {trigger <font color=#90ee90>&quot;axis&quot;</font>} <font color=#b9b96e>-animation</font> <font color=#90ee90>&quot;False&quot;</font> <font color=#b9b96e>-toolbox</font> {feature {dataZoom {yAxisIndex <font color=#90ee90>&quot;none&quot;</font>}}} <font color=#b9b96e>-backgroundColor</font> <font color=#90ee90>&quot;#212121&quot;</font>
<font color=#f1b479>$chartNorm</font> Add <font color=#90ee90>&quot;barSeries&quot;</font> <font color=#b9b96e>-data</font> [<b><font color=#ffa500>list</font></b> <font color=#f1b479>$normDist</font>]
<i><font color=#76a396># create multiplot</font></i>
<b><font color=#ffa500>set</font></b> layout [ticklecharts::Gridlayout new]
<font color=#f1b479>$layout</font> Add <font color=#f1b479>$chartNorm</font> <font color=#b9b96e>-bottom</font> <font color=#90ee90>&quot;10%&quot;</font> <font color=#b9b96e>-height</font> <font color=#90ee90>&quot;35%&quot;</font> <font color=#b9b96e>-width</font> <font color=#90ee90>&quot;75%&quot;</font>
<font color=#f1b479>$layout</font> Add <font color=#f1b479>$chartUni</font> <font color=#b9b96e>-bottom</font> <font color=#90ee90>&quot;60%&quot;</font> <font color=#b9b96e>-height</font> <font color=#90ee90>&quot;35%&quot;</font> <font color=#b9b96e>-width</font> <font color=#90ee90>&quot;75%&quot;</font>

<b><font color=#ffa500>set</font></b> fbasename [<b><font color=#ffa500>file</font></b> rootname [<b><font color=#ffa500>file</font></b> tail [<b><font color=#ffa500>info</font></b> script]]]
<font color=#f1b479>$layout</font> Render <font color=#b9b96e>-outfile</font> [<b><font color=#ffa500>file</font></b> normalize [<b><font color=#ffa500>file</font></b> join .. html_charts <font color=#f1b479>$fbasename</font>.html]] <font color=#b9b96e>-height</font> 800px <font color=#b9b96e>-width</font> 1200px
</pre>

</figure><p class='ruff'><!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>ticklEcharts !!!</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
  </head>
  <body>
    <div id="id_a655c9205dee4c819a02120a61da95fa" class="chart-container" style="width:1200px; height:800px;"></div>
    <script>
      var chart_a655c9205dee4c819a02120a61da95fa = echarts.init(document.getElementById("id_a655c9205dee4c819a02120a61da95fa"), null, {renderer: "canvas"});
      var option_a655c9205dee4c819a02120a61da95fa = {
  "darkMode": true,
  "backgroundColor": "#212121",
  "color": [
    "#4992ff",
    "#7cffb2",
    "#fddd60",
    "#ff6e76",
    "#58d9f9",
    "#05c091",
    "#ff8a45",
    "#8d48e3",
    "#dd79ff"
  ],
  "animation": false,
  "animationDuration": 1000,
  "animationDurationUpdate": 500,
  "animationEasing": "cubicInOut",
  "animationEasingUpdate": "cubicInOut",
  "animationThreshold": 2000,
  "progressiveThreshold": 3000,
  "xAxis": [
    {
      "show": true,
      "type": "category",
      "data": [
        "<=9.98e+05",
        "9.98e+05-1.01e+06",
        "1.01e+06-1.02e+06",
        "1.02e+06-1.04e+06",
        "1.04e+06-1.05e+06",
        "1.05e+06-1.06e+06",
        "1.06e+06-1.07e+06",
        "1.07e+06-1.09e+06",
        "1.09e+06-1.10e+06",
        "1.10e+06-1.11e+06",
        "1.11e+06-1.12e+06",
        "1.12e+06-1.14e+06",
        "1.14e+06-1.15e+06",
        "1.15e+06-1.16e+06",
        "1.16e+06-1.17e+06"
      ],
      "gridIndex": 0,
      "position": "bottom",
      "name": "Frequency intervals, Hz",
      "nameLocation": "end",
      "nameGap": 15,
      "nameRotate": 0,
      "inverse": false,
      "boundaryGap": true,
      "scale": false,
      "silent": false,
      "triggerEvent": false,
      "axisLine": {
        "show": true,
        "lineStyle": {
          "color": "#B9B8CE",
          "width": 1
        }
      },
      "axisTick": {
        "show": true,
        "alignWithLabel": true,
        "interval": "auto",
        "length": 5
      },
      "axisLabel": {
        "show": true,
        "interval": 0,
        "inside": false,
        "rotate": 45,
        "margin": 8,
        "showMinLabel": null,
        "showMaxLabel": null,
        "hideOverlap": false,
        "color": "#B9B8CE",
        "fontStyle": "normal",
        "fontWeight": "normal",
        "fontFamily": "sans-serif",
        "fontSize": 8,
        "lineHeight": 12,
        "backgroundColor": "transparent",
        "borderWidth": 0,
        "borderType": "solid",
        "borderDashOffset": 0,
        "borderRadius": 0,
        "padding": 0,
        "shadowColor": "transparent",
        "shadowBlur": 0,
        "shadowOffsetX": 0,
        "shadowOffsetY": 0,
        "textBorderColor": null,
        "textBorderWidth": 0,
        "textBorderType": "solid",
        "textBorderDashOffset": 0,
        "textShadowColor": "transparent",
        "textShadowBlur": 0,
        "textShadowOffsetX": 0,
        "textShadowOffsetY": 0,
        "overflow": "truncate",
        "ellipsis": "..."
      },
      "splitLine": {
        "show": false,
        "lineStyle": {
          "color": "#484753",
          "width": 1
        }
      },
      "zlevel": 0,
      "z": 0
    },
    {
      "show": true,
      "type": "category",
      "data": [
        "<=9.92e+05",
        "9.92e+05-1.01e+06",
        "1.01e+06-1.02e+06",
        "1.02e+06-1.04e+06",
        "1.04e+06-1.05e+06",
        "1.05e+06-1.07e+06",
        "1.07e+06-1.08e+06",
        "1.08e+06-1.09e+06",
        "1.09e+06-1.11e+06",
        "1.11e+06-1.12e+06",
        "1.12e+06-1.14e+06",
        "1.14e+06-1.15e+06",
        "1.15e+06-1.17e+06",
        "1.17e+06-1.18e+06",
        "1.18e+06-1.20e+06"
      ],
      "gridIndex": 1,
      "position": "bottom",
      "name": "Frequency intervals, Hz",
      "nameLocation": "end",
      "nameGap": 15,
      "nameRotate": 0,
      "inverse": false,
      "boundaryGap": true,
      "scale": false,
      "silent": false,
      "triggerEvent": false,
      "axisLine": {
        "show": true,
        "lineStyle": {
          "color": "#B9B8CE",
          "width": 1
        }
      },
      "axisTick": {
        "show": true,
        "alignWithLabel": true,
        "interval": "auto",
        "length": 5
      },
      "axisLabel": {
        "show": true,
        "interval": 0,
        "inside": false,
        "rotate": 45,
        "margin": 8,
        "showMinLabel": null,
        "showMaxLabel": null,
        "hideOverlap": false,
        "color": "#B9B8CE",
        "fontStyle": "normal",
        "fontWeight": "normal",
        "fontFamily": "sans-serif",
        "fontSize": 8,
        "lineHeight": 12,
        "backgroundColor": "transparent",
        "borderWidth": 0,
        "borderType": "solid",
        "borderDashOffset": 0,
        "borderRadius": 0,
        "padding": 0,
        "shadowColor": "transparent",
        "shadowBlur": 0,
        "shadowOffsetX": 0,
        "shadowOffsetY": 0,
        "textBorderColor": null,
        "textBorderWidth": 0,
        "textBorderType": "solid",
        "textBorderDashOffset": 0,
        "textShadowColor": "transparent",
        "textShadowBlur": 0,
        "textShadowOffsetX": 0,
        "textShadowOffsetY": 0,
        "overflow": "truncate",
        "ellipsis": "..."
      },
      "splitLine": {
        "show": false,
        "lineStyle": {
          "color": "#484753",
          "width": 1
        }
      },
      "zlevel": 0,
      "z": 0
    }
  ],
  "yAxis": [
    {
      "show": true,
      "gridIndex": 0,
      "position": "left",
      "realtimeSort": true,
      "sortSeriesIndex": 0,
      "type": "value",
      "name": "Bandwidths per interval",
      "nameLocation": "end",
      "nameGap": 15,
      "nameRotate": 0,
      "inverse": false,
      "boundaryGap": false,
      "scale": false,
      "silent": false,
      "triggerEvent": false,
      "axisLine": {
        "show": true,
        "lineStyle": {
          "color": "#B9B8CE",
          "width": 1
        }
      },
      "axisTick": {"show": true},
      "minorTick": {
        "show": true,
        "splitNumber": 5,
        "length": 3
      },
      "axisLabel": {"color": "#B9B8CE"},
      "splitLine": {
        "show": false,
        "lineStyle": {
          "color": "#484753",
          "width": 1
        }
      },
      "zlevel": 0,
      "z": 0
    },
    {
      "show": true,
      "gridIndex": 1,
      "position": "left",
      "realtimeSort": true,
      "sortSeriesIndex": 0,
      "type": "value",
      "name": "Bandwidths per interval",
      "nameLocation": "end",
      "nameGap": 15,
      "nameRotate": 0,
      "inverse": false,
      "boundaryGap": false,
      "scale": false,
      "silent": false,
      "triggerEvent": false,
      "axisLine": {
        "show": true,
        "lineStyle": {
          "color": "#B9B8CE",
          "width": 1
        }
      },
      "axisTick": {"show": true},
      "minorTick": {
        "show": true,
        "splitNumber": 5,
        "length": 3
      },
      "axisLabel": {"color": "#B9B8CE"},
      "splitLine": {
        "show": false,
        "lineStyle": {
          "color": "#484753",
          "width": 1
        }
      },
      "zlevel": 0,
      "z": 0
    }
  ],
  "title": [
    {
      "show": true,
      "target": "blank",
      "textStyle": {"color": "#EEF1FA"},
      "subtarget": "blank",
      "subtextStyle": {"color": "#B9B8CE"},
      "textAlign": null,
      "textVerticalAlign": "auto",
      "padding": 5,
      "itemGap": 10,
      "z": 2,
      "left": "auto",
      "top": "auto",
      "right": "auto",
      "bottom": "auto",
      "backgroundColor": "transparent",
      "borderColor": "transparent",
      "borderWidth": 1,
      "borderRadius": 0
    },
    {
      "show": true,
      "target": "blank",
      "textStyle": {"color": "#EEF1FA"},
      "subtarget": "blank",
      "subtextStyle": {"color": "#B9B8CE"},
      "textAlign": null,
      "textVerticalAlign": "auto",
      "padding": 5,
      "itemGap": 10,
      "z": 2,
      "left": "auto",
      "top": "auto",
      "right": "auto",
      "bottom": "auto",
      "backgroundColor": "transparent",
      "borderColor": "transparent",
      "borderWidth": 1,
      "borderRadius": 0
    }
  ],
  "tooltip": [
    {
      "show": true,
      "trigger": "axis",
      "showContent": true,
      "alwaysShowContent": false,
      "triggerOn": "mousemove|click",
      "transitionDuration": 0.4,
      "padding": 5,
      "order": "seriesAsc"
    },
    {
      "show": true,
      "trigger": "axis",
      "showContent": true,
      "alwaysShowContent": false,
      "triggerOn": "mousemove|click",
      "transitionDuration": 0.4,
      "padding": 5,
      "order": "seriesAsc"
    }
  ],
  "toolbox": {
    "show": true,
    "orient": "horizontal",
    "itemSize": 15,
    "itemGap": 10,
    "showTitle": true,
    "feature": {"dataZoom": {
        "show": true,
        "filterMode": "filter",
        "yAxisIndex": "none"
      }},
    "iconStyle": {"borderColor": "#B9B8CE"},
    "z": 2,
    "top": "auto",
    "right": "auto",
    "width": "auto",
    "height": "auto",
    "24": {
      "show": true,
      "orient": "horizontal",
      "itemSize": 15,
      "itemGap": 10,
      "showTitle": true,
      "feature": {"dataZoom": {
          "show": true,
          "filterMode": "filter",
          "yAxisIndex": "none"
        }},
      "iconStyle": {"borderColor": "#B9B8CE"},
      "z": 2,
      "top": "auto",
      "right": "auto",
      "width": "auto",
      "height": "auto"
    }
  },
  "series": [
    {
      "type": "bar",
      "name": "barseries_2",
      "colorBy": "series",
      "legendHoverLink": true,
      "coordinateSystem": "cartesian2d",
      "roundCap": false,
      "showBackground": false,
      "label": {"color": "#B9B8CE"},
      "stack": null,
      "sampling": "max",
      "cursor": "pointer",
      "barMinWidth": null,
      "barCategoryGap": "20%",
      "large": false,
      "largeThreshold": 400,
      "data": [
        1,
        0,
        6,
        10,
        29,
        83,
        193,
        113,
        190,
        176,
        78,
        88,
        18,
        10,
        5
      ],
      "zlevel": 0,
      "z": 2,
      "silent": false,
      "xAxisIndex": 0,
      "yAxisIndex": 0
    },
    {
      "type": "bar",
      "name": "barseries_1",
      "colorBy": "series",
      "legendHoverLink": true,
      "coordinateSystem": "cartesian2d",
      "roundCap": false,
      "showBackground": false,
      "label": {"color": "#B9B8CE"},
      "stack": null,
      "sampling": "max",
      "cursor": "pointer",
      "barMinWidth": null,
      "barCategoryGap": "20%",
      "large": false,
      "largeThreshold": 400,
      "data": [
        1,
        17,
        44,
        82,
        102,
        117,
        108,
        94,
        77,
        81,
        91,
        86,
        60,
        32,
        8
      ],
      "zlevel": 0,
      "z": 2,
      "silent": false,
      "xAxisIndex": 1,
      "yAxisIndex": 1
    }
  ],
  "grid": [
    {
      "bottom": "10%",
      "width": "75%",
      "height": "35%"
    },
    {
      "bottom": "60%",
      "width": "75%",
      "height": "35%"
    }
  ]
};
      chart_a655c9205dee4c819a02120a61da95fa.setOption(option_a655c9205dee4c819a02120a61da95fa);
    </script>
  </body>
</html>
</p>
<p class='ruff'>We can clearly see the difference between normal and uniform distributions; the intervals are close due to setting the standard deviation of the normal distribution as std = (xmax - xmin) / 6.</p>
<p class='ruff'>We can also take the uniform intervals and calculate the normal distribution values at these intervals:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><i><font color=#76a396># find distribution of normal distributed values in uniform intervals       </font></i>
<b><font color=#ffa500>set</font></b> normDistWithUniIntervals [createDist <font color=#f1b479>$bwsNorm</font> [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$uniIntervals</font> intervals]]
<b><font color=#ffa500>set</font></b> chartCombined [ticklecharts::chart new]
<font color=#f1b479>$chartCombined</font> Xaxis <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;Frequency intervals, Hz&quot;</font> <font color=#b9b96e>-data</font> [<b><font color=#ffa500>list</font></b> [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$uniIntervals</font> intervalsStr]] <font color=#b9b96e>-axisTick</font> {show <font color=#90ee90>&quot;True&quot;</font> alignWithLabel <font color=#90ee90>&quot;True&quot;</font>} <font color=#b9b96e>-axisLabel</font> {interval <font color=#90ee90>&quot;0&quot;</font> rotate <font color=#90ee90>&quot;45&quot;</font> fontSize <font color=#90ee90>&quot;8&quot;</font>}
<font color=#f1b479>$chartCombined</font> Yaxis <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;Bandwidths per interval&quot;</font> <font color=#b9b96e>-minorTick</font> {show <font color=#90ee90>&quot;True&quot;</font>} <font color=#b9b96e>-type</font> <font color=#90ee90>&quot;value&quot;</font>
<font color=#f1b479>$chartCombined</font> SetOptions <font color=#b9b96e>-title</font> {} <font color=#b9b96e>-legend</font> {} <font color=#b9b96e>-tooltip</font> {trigger <font color=#90ee90>&quot;axis&quot;</font>} <font color=#b9b96e>-animation</font> <font color=#90ee90>&quot;False&quot;</font> <font color=#b9b96e>-toolbox</font> {feature {dataZoom {yAxisIndex <font color=#90ee90>&quot;none&quot;</font>}}} <font color=#b9b96e>-grid</font> {left <font color=#90ee90>&quot;10%&quot;</font> right <font color=#90ee90>&quot;15%&quot;</font>} <font color=#b9b96e>-backgroundColor</font> <font color=#90ee90>&quot;#212121&quot;</font>
<font color=#f1b479>$chartCombined</font> Add <font color=#90ee90>&quot;barSeries&quot;</font> <font color=#b9b96e>-data</font> [<b><font color=#ffa500>list</font></b> <font color=#f1b479>$uniDist</font>] <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;Uniform&quot;</font>
<font color=#f1b479>$chartCombined</font> Add <font color=#90ee90>&quot;barSeries&quot;</font> <font color=#b9b96e>-data</font> [<b><font color=#ffa500>list</font></b> <font color=#f1b479>$normDistWithUniIntervals</font>] <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;Normal&quot;</font>
<font color=#f1b479>$chartCombined</font> Render <font color=#b9b96e>-outfile</font> [<b><font color=#ffa500>file</font></b> normalize [<b><font color=#ffa500>file</font></b> join .. html_charts <font color=#f1b479>${fbasename}</font>_combined.html]] <font color=#b9b96e>-height</font> 800px <font color=#b9b96e>-width</font> 1200px
</pre>

</figure><p class='ruff'><!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>ticklEcharts !!!</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
  </head>
  <body>
    <div id="id_824141ca08254f478d66c0388fbc9f3b" class="chart-container" style="width:1200px; height:800px;"></div>
    <script>
      var chart_824141ca08254f478d66c0388fbc9f3b = echarts.init(document.getElementById("id_824141ca08254f478d66c0388fbc9f3b"), null, {renderer: "canvas"});
      var option_824141ca08254f478d66c0388fbc9f3b = {
  "xAxis": [{
      "show": true,
      "type": "category",
      "data": [
        "<=9.92e+05",
        "9.92e+05-1.01e+06",
        "1.01e+06-1.02e+06",
        "1.02e+06-1.04e+06",
        "1.04e+06-1.05e+06",
        "1.05e+06-1.07e+06",
        "1.07e+06-1.08e+06",
        "1.08e+06-1.09e+06",
        "1.09e+06-1.11e+06",
        "1.11e+06-1.12e+06",
        "1.12e+06-1.14e+06",
        "1.14e+06-1.15e+06",
        "1.15e+06-1.17e+06",
        "1.17e+06-1.18e+06",
        "1.18e+06-1.20e+06"
      ],
      "gridIndex": 0,
      "position": "bottom",
      "name": "Frequency intervals, Hz",
      "nameLocation": "end",
      "nameGap": 15,
      "nameRotate": 0,
      "inverse": false,
      "boundaryGap": true,
      "scale": false,
      "silent": false,
      "triggerEvent": false,
      "axisLine": {
        "show": true,
        "lineStyle": {
          "color": "#B9B8CE",
          "width": 1
        }
      },
      "axisTick": {
        "show": true,
        "alignWithLabel": true,
        "interval": "auto",
        "length": 5
      },
      "axisLabel": {
        "show": true,
        "interval": 0,
        "inside": false,
        "rotate": 45,
        "margin": 8,
        "showMinLabel": null,
        "showMaxLabel": null,
        "hideOverlap": false,
        "color": "#B9B8CE",
        "fontStyle": "normal",
        "fontWeight": "normal",
        "fontFamily": "sans-serif",
        "fontSize": 8,
        "lineHeight": 12,
        "backgroundColor": "transparent",
        "borderWidth": 0,
        "borderType": "solid",
        "borderDashOffset": 0,
        "borderRadius": 0,
        "padding": 0,
        "shadowColor": "transparent",
        "shadowBlur": 0,
        "shadowOffsetX": 0,
        "shadowOffsetY": 0,
        "textBorderColor": null,
        "textBorderWidth": 0,
        "textBorderType": "solid",
        "textBorderDashOffset": 0,
        "textShadowColor": "transparent",
        "textShadowBlur": 0,
        "textShadowOffsetX": 0,
        "textShadowOffsetY": 0,
        "overflow": "truncate",
        "ellipsis": "..."
      },
      "splitLine": {
        "show": false,
        "lineStyle": {
          "color": "#484753",
          "width": 1
        }
      },
      "zlevel": 0,
      "z": 0
    }],
  "yAxis": [{
      "show": true,
      "gridIndex": 0,
      "position": "left",
      "realtimeSort": true,
      "sortSeriesIndex": 0,
      "type": "value",
      "name": "Bandwidths per interval",
      "nameLocation": "end",
      "nameGap": 15,
      "nameRotate": 0,
      "inverse": false,
      "boundaryGap": false,
      "scale": false,
      "silent": false,
      "triggerEvent": false,
      "axisLine": {
        "show": true,
        "lineStyle": {
          "color": "#B9B8CE",
          "width": 1
        }
      },
      "axisTick": {"show": true},
      "minorTick": {
        "show": true,
        "splitNumber": 5,
        "length": 3
      },
      "axisLabel": {"color": "#B9B8CE"},
      "splitLine": {
        "show": false,
        "lineStyle": {
          "color": "#484753",
          "width": 1
        }
      },
      "zlevel": 0,
      "z": 0
    }],
  "darkMode": true,
  "backgroundColor": "#212121",
  "color": [
    "#4992ff",
    "#7cffb2",
    "#fddd60",
    "#ff6e76",
    "#58d9f9",
    "#05c091",
    "#ff8a45",
    "#8d48e3",
    "#dd79ff"
  ],
  "animation": false,
  "animationDuration": 1000,
  "animationDurationUpdate": 500,
  "animationEasing": "cubicInOut",
  "animationEasingUpdate": "cubicInOut",
  "animationThreshold": 2000,
  "progressiveThreshold": 3000,
  "title": [{
      "show": true,
      "target": "blank",
      "textStyle": {"color": "#EEF1FA"},
      "subtarget": "blank",
      "subtextStyle": {"color": "#B9B8CE"},
      "textAlign": null,
      "textVerticalAlign": "auto",
      "padding": 5,
      "itemGap": 10,
      "z": 2,
      "left": "auto",
      "top": "auto",
      "right": "auto",
      "bottom": "auto",
      "backgroundColor": "transparent",
      "borderColor": "transparent",
      "borderWidth": 1,
      "borderRadius": 0
    }],
  "legend": [{
      "type": "plain",
      "show": true,
      "z": 2,
      "left": "center",
      "top": "auto",
      "right": "auto",
      "bottom": "auto",
      "width": "auto",
      "height": "auto",
      "orient": "horizontal",
      "align": "auto",
      "padding": 5,
      "itemGap": 10,
      "itemWidth": 25,
      "itemHeight": 14,
      "symbolRotate": "inherit",
      "selectedMode": true,
      "inactiveColor": "rgb(204, 204, 204)",
      "inactiveBorderColor": "rgb(204, 204, 204)",
      "inactiveBorderWidth": "auto",
      "textStyle": {"color": "#B9B8CE"},
      "backgroundColor": "transparent",
      "borderWidth": 0,
      "borderRadius": 0,
      "pageButtonItemGap": 5,
      "pageIconColor": "rgb(47, 69, 84)",
      "pageIconInactiveColor": "rgb(170, 170, 170)",
      "pageIconSize": 15
    }],
  "tooltip": [{
      "show": true,
      "trigger": "axis",
      "showContent": true,
      "alwaysShowContent": false,
      "triggerOn": "mousemove|click",
      "transitionDuration": 0.4,
      "padding": 5,
      "order": "seriesAsc"
    }],
  "grid": [{
      "left": "10%",
      "right": "15%"
    }],
  "toolbox": {
    "show": true,
    "orient": "horizontal",
    "itemSize": 15,
    "itemGap": 10,
    "showTitle": true,
    "feature": {"dataZoom": {
        "show": true,
        "filterMode": "filter",
        "yAxisIndex": "none"
      }},
    "iconStyle": {"borderColor": "#B9B8CE"},
    "z": 2,
    "top": "auto",
    "right": "auto",
    "width": "auto",
    "height": "auto"
  },
  "series": [
    {
      "type": "bar",
      "name": "Uniform",
      "colorBy": "series",
      "legendHoverLink": true,
      "coordinateSystem": "cartesian2d",
      "roundCap": false,
      "showBackground": false,
      "label": {"color": "#B9B8CE"},
      "sampling": "max",
      "cursor": "pointer",
      "barMinWidth": null,
      "barCategoryGap": "20%",
      "large": false,
      "largeThreshold": 400,
      "data": [
        1,
        17,
        44,
        82,
        102,
        117,
        108,
        94,
        77,
        81,
        91,
        86,
        60,
        32,
        8
      ],
      "zlevel": 0,
      "z": 2,
      "silent": false
    },
    {
      "type": "bar",
      "name": "Normal",
      "colorBy": "series",
      "legendHoverLink": true,
      "coordinateSystem": "cartesian2d",
      "roundCap": false,
      "showBackground": false,
      "label": {"color": "#B9B8CE"},
      "sampling": "max",
      "cursor": "pointer",
      "barMinWidth": null,
      "barCategoryGap": "20%",
      "large": false,
      "largeThreshold": 400,
      "data": [
        0,
        1,
        6,
        10,
        69,
        121,
        228,
        190,
        153,
        101,
        88,
        26,
        6,
        1,
        0
      ],
      "zlevel": 0,
      "z": 2,
      "silent": false
    }
  ]
};
      chart_824141ca08254f478d66c0388fbc9f3b.setOption(option_824141ca08254f478d66c0388fbc9f3b);
    </script>
  </body>
</html>
</p>
<h2 class='ruff'><a name='::Advanced-Parameters extraction of diode model parameters'></a>Parameters extraction of diode model parameters<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h2>
<div style='clear:both;'></div>
<p class='ruff'>In this advanced example we will do curve fitting procedure to extract parameters of diode model. We use measured (emulated with more advanced diode model generated data, with added small distorsion and make non-equal voltage steps) forward current characteristic of diode.</p>
<p class='ruff'>This example demands two additional Tcl packages to make fast interpolation and Levenberg-Marquardt optimization algorithm:</p>
<ul class='ruff'>
<li><a href="https://github.com/georgtree/tclopt" >Optimization package</a></li>
<li><a href="https://github.com/georgtree/tclinterp" >Interpolation package</a></li>
</ul>
<p class='ruff'>Also, the <a href="https://tclcsv.magicsplat.com/" >tclcsv</a> package is used for data reading.</p>
<p class='ruff'>The main steps of this procedure are:</p>
<ul class='ruff'>
<li>Create cost function that calculates difference between simulated and measured data, and which should be minimized</li>
<li>Select the region of optimization</li>
<li>Set list of parameters that will be extracted, define lower and upper limits for them.</li>
<li>Run optimization</li>
<li>Use resulted values as initial values for next optimization in different region</li>
<li>...</li>
<li>Repeat until the quality of fitting reaches required level.</li>
</ul>
<p class='ruff'>First step is to define the cost function that will be used by the optimizer:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#fe6efe>proc</font></b> diodeIVcalc {xall pdata args} {
    <b><font color=#ffa500>dict</font></b> with pdata {}
    <font color=#f1b479>$model</font> setParamValue is [@ <font color=#f1b479>$xall</font> 0] n [@ <font color=#f1b479>$xall</font> 1] rs [@ <font color=#f1b479>$xall</font> 2] ikf [@ <font color=#f1b479>$xall</font> 3]
    <font color=#f1b479>$vSrc</font> setParamValue start <font color=#f1b479>$vMin</font> stop <font color=#f1b479>$vMax</font> incr <font color=#f1b479>$vStep</font>
    <font color=#f1b479>$circuit</font> runAndRead
    <b><font color=#ffa500>set</font></b> data [<font color=#f1b479>$circuit</font> getDataDict]
    <b><font color=#ffa500>foreach</font></b> iVal <font color=#f1b479>$i</font> iSim [<b><font color=#ffa500>lmap</font></b> i [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$data</font> i(va)] {= {-<font color=#f1b479>$i</font>}}] {
        <b><font color=#ffa500>lappend</font></b> fvec [= {log(abs(<font color=#f1b479>$iVal</font>))-log(abs(<font color=#f1b479>$iSim</font>))}]
        <b><font color=#ffa500>lappend</font></b> fval <font color=#f1b479>$iSim</font>
    }
    <b><font color=#fe6efe>return</font></b> [<b><font color=#ffa500>dcreate</font></b> fvec <font color=#f1b479>$fvec</font> fval <font color=#f1b479>$fval</font>]
}
</pre>

</figure><p class='ruff'>The input arguments are:</p>
<ul class='ruff'>
<li><code>xall</code> - list with fitting parameters, in our case, the parameters of the diode model.</li>
<li><code>pdata</code> - the dictionary containing information that allows to calculate cost function, in our case it contains multiple fields that will be explained below.</li>
<li><code>args</code> - any additional arguments, usually is used for passing information for calculating analytic derivatives.</li>
</ul>
<p class='ruff'>Let me expand the values in <code>pdata</code> dictionary:</p>
<ul class='ruff'>
<li><code>v</code> - list of applied voltages values</li>
<li><code>i</code> - list of measured current values</li>
<li><code>circuit</code> - top circuit object simulating forward diode current</li>
<li><code>model</code> - diode model object</li>
<li><code>vMin</code> - start of the voltage region</li>
<li><code>vMax</code> - end of the voltage region</li>
<li><code>vStep</code> - size of voltage step</li>
<li><code>vSrc</code> - voltage source object</li>
</ul>
<p class='ruff'>First line creates variables with the same name as keys of <code>pdata</code> dictionary:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>dict</font></b> with pdata {}
</pre>

</figure><p class='ruff'>Then we set parameters values of the diode model object using <a href="index-SpiceGenTcl.html#::SpiceGenTcl::Model::setParamValue" title="::SpiceGenTcl::Model::setParamValue" class='ruff_cmd'>::SpiceGenTcl::Model::setParamValue</a> method:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><font color=#f1b479>$model</font> setParamValue is [@ <font color=#f1b479>$xall</font> 0] n [@ <font color=#f1b479>$xall</font> 1] rs [@ <font color=#f1b479>$xall</font> 2] ikf [@ <font color=#f1b479>$xall</font> 3]
</pre>

</figure><p class='ruff'>The same we do with voltage source element:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><font color=#f1b479>$vSrc</font> setParamValue start <font color=#f1b479>$vMin</font> stop <font color=#f1b479>$vMax</font> incr <font color=#f1b479>$vStep</font>
</pre>

</figure><p class='ruff'>Then we run circuit with new parameters and read data back to calculate residuals:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><font color=#f1b479>$circuit</font> runAndRead
<b><font color=#ffa500>set</font></b> data [<font color=#f1b479>$circuit</font> getDataDict]
</pre>

</figure><p class='ruff'>Calculating residuals and save simulated data in the loop:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>foreach</font></b> iVal <font color=#f1b479>$i</font> iSim [<b><font color=#ffa500>lmap</font></b> i [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$data</font> i(va)] {= {-<font color=#f1b479>$i</font>}}] {
    <b><font color=#ffa500>lappend</font></b> fvec [= {log(abs(<font color=#f1b479>$iVal</font>))-log(abs(<font color=#f1b479>$iSim</font>))}]
    <b><font color=#ffa500>lappend</font></b> fval <font color=#f1b479>$iSim</font>
}
</pre>

</figure><p class='ruff'>The residuals is calculated with the next formula:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>f = log |i    | - log |i   |
        | meas|       | sim|
</pre>

</figure><p class='ruff'>We use logarithm of values because the current values span across multiple orders, from 1e-8 to 1e-2, that creates issue for fitting algorithm.</p>
<p class='ruff'>Procedure returns dictionary that contains lists with residuals and diode current under the keys <code>fvec</code> and <code>fval</code>, and <code>fvec</code> key is mandatory because list under this key is used by optimization procedure.</p>
<p class='ruff'>To run simulation we need to build circuit and define necessary objects:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> diodeModel [DiodeModel new diomod <font color=#b9b96e>-is</font> 1e-12 <font color=#b9b96e>-n</font> 1.0 <font color=#b9b96e>-rs</font> 30 <font color=#b9b96e>-cj0</font> 1e-9 <font color=#b9b96e>-trs1</font> 0.001 <font color=#b9b96e>-xti</font> 5 <font color=#b9b96e>-ikf</font> 1e-4]
<b><font color=#ffa500>set</font></b> vSrc [<b><font color=#ffa500>Dc</font></b> new <font color=#b9b96e>-src</font> va <font color=#b9b96e>-start</font> 0 <font color=#b9b96e>-stop</font> 2 <font color=#b9b96e>-incr</font> 0.02]
<b><font color=#ffa500>set</font></b> circuit [<b><font color=#ffa500>Circuit</font></b> new {diode IV}]
<font color=#f1b479>$circuit</font> add [<b><font color=#ffa500>D</font></b> new 1 anode 0 <font color=#b9b96e>-model</font> diomod <font color=#b9b96e>-area</font> 1]
<font color=#f1b479>$circuit</font> add [<b><font color=#ffa500>Vdc</font></b> new a anode 0 <font color=#b9b96e>-dc</font> 0]
<font color=#f1b479>$circuit</font> add <font color=#f1b479>$diodeModel</font>
<font color=#f1b479>$circuit</font> add <font color=#f1b479>$vSrc</font>
<b><font color=#ffa500>set</font></b> tempSt [<b><font color=#ffa500>Temp</font></b> new 25]
<font color=#f1b479>$circuit</font> add <font color=#f1b479>$tempSt</font>
<font color=#f1b479>$circuit</font> configure <font color=#b9b96e>-simulator</font> [<b><font color=#ffa500>Batch</font></b> new {batch1}]
</pre>

</figure><p class='ruff'>We save object references for diode model and voltage source into dedicated variable to use it in cost function - it will be saved into <code>pdata</code> dictionary.</p>
<p class='ruff'>Next, we read measured data from .csv file with <code>tclcsv</code> package:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> file [<b><font color=#ffa500>open</font></b> [<b><font color=#ffa500>file</font></b> join <font color=#f1b479>$fileDataPath</font> iv25.csv]]
<b><font color=#ffa500>set</font></b> ivTemp25 [csv_read <font color=#b9b96e>-startline</font> 1 <font color=#f1b479>$file</font>]
<b><font color=#ffa500>close</font></b> <font color=#f1b479>$file</font>
<b><font color=#ffa500>set</font></b> vRaw [<b><font color=#ffa500>lmap</font></b> elem <font color=#f1b479>$ivTemp25</font> {@ <font color=#f1b479>$elem</font> 0}]
<b><font color=#ffa500>set</font></b> iRaw [<b><font color=#ffa500>lmap</font></b> elem <font color=#f1b479>$ivTemp25</font> {@ <font color=#f1b479>$elem</font> 1}]
</pre>

</figure><p class='ruff'>The loaded data is (with selected regions of fitting):</p>
<p class='ruff'><img src="assets/img/iv_diode_extraction_plots.png" alt="drawing" width="900"/></p>
<h3 class='ruff'><a name='::Advanced-Fitting in first region'></a>Fitting in first region<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>First region we want to fit is the region of ideal diode, it spans from minimum voltage to approximately 0.85V. We set these limits in variables <code>vMin</code>, <code>vMax</code> and define the equal step of voltage <code>vStep</code>.</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> vMin [min {<b><font color=#ffa500>*</font></b>}<font color=#f1b479>$vRaw</font>]
<b><font color=#ffa500>set</font></b> vMax 0.85
<b><font color=#ffa500>set</font></b> vStep 0.02
</pre>

</figure><p class='ruff'>We use fixed voltage step instead of data points defined in measured data with non-equal steps to ease the defining the sweep of voltage in simulator - we can use DC sweep of voltage source with fixed step. So, we use linear interpolation to get values of current at even grid with defined minimum and maximum values. Then, we create <code>pdata</code> dictionary with corresponding values:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> vInterp [lseq <font color=#f1b479>$vMin</font> to <font color=#f1b479>$vMax</font> by <font color=#f1b479>$vStep</font>]
<b><font color=#ffa500>set</font></b> iInterp [lin1d <font color=#b9b96e>-x</font> <font color=#f1b479>$vRaw</font> <font color=#b9b96e>-y</font> <font color=#f1b479>$iRaw</font> <font color=#b9b96e>-xi</font> <font color=#f1b479>$vInterp</font>]
<b><font color=#ffa500>set</font></b> pdata [<b><font color=#ffa500>dcreate</font></b> v <font color=#f1b479>$vInterp</font> i <font color=#f1b479>$iInterp</font> circuit <font color=#f1b479>$circuit</font> model <font color=#f1b479>$diodeModel</font> vMin <font color=#f1b479>$vMin</font> vMax <font color=#f1b479>$vMax</font> vStep <font color=#f1b479>$vStep</font> vSrc <font color=#f1b479>$vSrc</font>]
</pre>

</figure><p class='ruff'>Command <code>lin1d</code> is imported from <code>tclinterp</code> package.</p>
<p class='ruff'>Parameters that we need to find (extract) are:</p>
<table class='ruff_deflist'>
<tr><td><code>is</code></td><td>Saturation current.</td></tr>
<tr><td><code>n</code></td><td>Ideality factor.</td></tr>
<tr><td><code>rs</code></td><td>Series resistance.</td></tr>
<tr><td><code>ikf</code></td><td>Forward knee current.</td></tr>
</table>
<p class='ruff'>In first region the parameters of interest are <code>n</code> and <code>is0</code> - it affects current curve the most in this region.</p>
<p class='ruff'>Parameter are represented as special objects <code>::tclopt::ParameterMpfit</code> from <code>tclopt</code> package, where we can define initial values and lower/upper limits:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> iniPars [<b><font color=#ffa500>list</font></b> 1e-14 1.0 30 1e-4]
<b><font color=#ffa500>set</font></b> par0 [::tclopt::ParameterMpfit new is [@ <font color=#f1b479>$iniPars</font> 0] <font color=#b9b96e>-lowlim</font> 1e-17 <font color=#b9b96e>-uplim</font> 1e-12]
<b><font color=#ffa500>set</font></b> par1 [::tclopt::ParameterMpfit new n [@ <font color=#f1b479>$iniPars</font> 1] <font color=#b9b96e>-lowlim</font> 0.5 <font color=#b9b96e>-uplim</font> 2]
<b><font color=#ffa500>set</font></b> par2 [::tclopt::ParameterMpfit new rs [@ <font color=#f1b479>$iniPars</font> 2] <font color=#b9b96e>-fixed</font> <font color=#b9b96e>-lowlim</font> 1e-10 <font color=#b9b96e>-uplim</font> 100]
<b><font color=#ffa500>set</font></b> par3 [::tclopt::ParameterMpfit new ikf [@ <font color=#f1b479>$iniPars</font> 3] <font color=#b9b96e>-fixed</font> <font color=#b9b96e>-lowlim</font> 1e-12 <font color=#b9b96e>-uplim</font> 0.1]
</pre>

</figure><p class='ruff'>For <code>rs</code> and <code>ikf</code> parameters we specify option <code><font color=#b9b96e>-fixed</font></code> to make them constant during the first region fitting.</p>
<p class='ruff'>Optimization is done with Levenberg-Marquardt algorithm based optimizator from <code>tclopt</code> package. First step is to create <code>::tclopt::Mpfit</code> object that defines the optimization parameters:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> optimizer [::tclopt::Mpfit new <font color=#b9b96e>-funct</font> diodeIVcalc <font color=#b9b96e>-m</font> [<b><font color=#ffa500>llength</font></b> <font color=#f1b479>$vInterp</font>] <font color=#b9b96e>-pdata</font> <font color=#f1b479>$pdata</font>]
</pre>

</figure><p class='ruff'>The arguments we pass here are:</p>
<table class='ruff_deflist'>
<tr><td><code><font color=#b9b96e>-funct</font></code></td><td>Name of the procedure calculating the residuals.</td></tr>
<tr><td><code><font color=#b9b96e>-m</font></code></td><td>Number of fitting points.</td></tr>
<tr><td><code><font color=#b9b96e>-pdata</font></code></td><td>Dictionary that is passed to cost function procedure.</td></tr>
</table>
<p class='ruff'>Then we add parameters to <code><font color=#f1b479>$optimizer</font></code> object, and the order of adding them should match the order of the elements list <code>xall</code> we pass values to cost function:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><font color=#f1b479>$optimizer</font> addPars <font color=#f1b479>$par0</font> <font color=#f1b479>$par1</font> <font color=#f1b479>$par2</font> <font color=#f1b479>$par3</font>
</pre>

</figure><p class='ruff'>Then we can run the simulation, read the resulted list of parameters <code>x</code> and print formatted values:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> result [<font color=#f1b479>$optimizer</font> run]
<b><font color=#ffa500>set</font></b> resPars [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$result</font> x]
<b><font color=#ffa500>puts</font></b> [<b><font color=#ffa500>format</font></b> <font color=#90ee90>&quot;is=%.3e, n=%.3e, rs=%.3e, ikf=%.3e&quot;</font> {<b><font color=#ffa500>*</font></b>}[<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$result</font> x]]
</pre>

</figure><p class='ruff'>The result is:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>is=5.771e-17, n=1.050e+00, rs=3.000e+01, ikf=1.000e-04
</pre>

</figure><p class='ruff'>You can notice that <code>is</code> and <code>n</code> now have different values, and <code>rs</code> and <code>ikf</code> remains the same because of <code><font color=#b9b96e>-fixed</font></code> option.</p>
<h3 class='ruff'><a name='::Advanced-Fitting in second region'></a>Fitting in second region<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Now we are ready to fit curve in the second ohmic/high-injection region. It started at the upper end of first region and continue until the end of the data. We interpolate this range with the same voltage step:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> vMin 0.85
<b><font color=#ffa500>set</font></b> vMax [max {<b><font color=#ffa500>*</font></b>}<font color=#f1b479>$vRaw</font>]
<b><font color=#ffa500>set</font></b> vInterp [lseq <font color=#f1b479>$vMin</font> to <font color=#f1b479>$vMax</font> by <font color=#f1b479>$vStep</font>]
<b><font color=#ffa500>set</font></b> iInterp [lin1d <font color=#b9b96e>-x</font> <font color=#f1b479>$vRaw</font> <font color=#b9b96e>-y</font> <font color=#f1b479>$iRaw</font> <font color=#b9b96e>-xi</font> <font color=#f1b479>$vInterp</font>]
</pre>

</figure><p class='ruff'>We will use the same <code>pdata</code> variable containing dictionary, but change the current and voltage data and limits:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>dset pdata v <font color=#f1b479>$vInterp</font>
dset pdata i <font color=#f1b479>$iInterp</font>
dset pdata vMin <font color=#f1b479>$vMin</font>
dset pdata vMax <font color=#f1b479>$vMax</font>
</pre>

</figure><p class='ruff'>We make <code>is</code> and <code>n</code> parameters fixed this time, and free the <code>rs</code> and <code>ikf</code>:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><font color=#f1b479>$par0</font> configure <font color=#b9b96e>-fixed</font> 1 <font color=#b9b96e>-initval</font> [@ <font color=#f1b479>$resPars</font> 0]
<font color=#f1b479>$par1</font> configure <font color=#b9b96e>-fixed</font> 1 <font color=#b9b96e>-initval</font> [@ <font color=#f1b479>$resPars</font> 1]
<font color=#f1b479>$par2</font> configure <font color=#b9b96e>-fixed</font> 0
<font color=#f1b479>$par3</font> configure <font color=#b9b96e>-fixed</font> 0
</pre>

</figure><p class='ruff'>You can notice that we supply the resulted values of <code>is</code> and <code>n</code> as the initial values to the second fitting, so we have two parameters already fitted before start the next optimization.</p>
<p class='ruff'>Replace <code><font color=#f1b479>$optimizer</font></code> object fields with the new values:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><font color=#f1b479>$optimizer</font> configure <font color=#b9b96e>-m</font> [<b><font color=#ffa500>llength</font></b> <font color=#f1b479>$vInterp</font>] <font color=#b9b96e>-pdata</font> <font color=#f1b479>$pdata</font>
</pre>

</figure><p class='ruff'>Run, read result and print new parameters values:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> result [<font color=#f1b479>$optimizer</font> run]
<b><font color=#ffa500>set</font></b> fittedIdiode [<b><font color=#ffa500>dget</font></b> [diodeIVcalc [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$result</font> x] <font color=#f1b479>$pdata</font>] fval]
<b><font color=#ffa500>set</font></b> resPars [<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$result</font> x]
<b><font color=#ffa500>puts</font></b> [<b><font color=#ffa500>format</font></b> <font color=#90ee90>&quot;is=%.3e, n=%.3e, rs=%.3e, ikf=%.3e&quot;</font> {<b><font color=#ffa500>*</font></b>}[<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$result</font> x]]
</pre>

</figure><p class='ruff'>The result is:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>is=5.771e-17, n=1.050e+00, rs=5.430e+00, ikf=3.069e-04
</pre>

</figure><p class='ruff'>Now we can see that <code>rs</code> and <code>ikf</code> were changed during fitting, just as planned.</p>
<h3 class='ruff'><a name='::Advanced-Fitting the whole curve'></a>Fitting the whole curve<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>The last step is the fitting to the whole curve, with initial values of parameters replaced with resulted values.</p>
<p class='ruff'>Again, set voltage limits to minimum and maximum of the data, interpolate it and replace data in <code><font color=#f1b479>$pdata</font></code> dictionary:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> vMin [min {<b><font color=#ffa500>*</font></b>}<font color=#f1b479>$vRaw</font>]
<b><font color=#ffa500>set</font></b> vMax [max {<b><font color=#ffa500>*</font></b>}<font color=#f1b479>$vRaw</font>]
<b><font color=#ffa500>set</font></b> vInterp [lseq <font color=#f1b479>$vMin</font> to <font color=#f1b479>$vMax</font> by <font color=#f1b479>$vStep</font>]
<b><font color=#ffa500>set</font></b> iInterp [lin1d <font color=#b9b96e>-x</font> <font color=#f1b479>$vRaw</font> <font color=#b9b96e>-y</font> <font color=#f1b479>$iRaw</font> <font color=#b9b96e>-xi</font> <font color=#f1b479>$vInterp</font>]
dset pdata v <font color=#f1b479>$vInterp</font>
dset pdata i <font color=#f1b479>$iInterp</font>
dset pdata vMin <font color=#f1b479>$vMin</font>
dset pdata vMax <font color=#f1b479>$vMax</font>
</pre>

</figure><p class='ruff'>We unfix <code>rs</code> and <code>ikf</code> parameters, and set new limits within 10% of previous values to forbid parameters becoming too different:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><font color=#f1b479>$par0</font> configure <font color=#b9b96e>-fixed</font> 0 <font color=#b9b96e>-initval</font> [@ <font color=#f1b479>$resPars</font> 0] <font color=#b9b96e>-lowlim</font> [= {[@ <font color=#f1b479>$resPars</font> 0]*0.9}] <font color=#b9b96e>-uplim</font> [= {[@ <font color=#f1b479>$resPars</font> 0]*1.1}]
<font color=#f1b479>$par1</font> configure <font color=#b9b96e>-fixed</font> 0 <font color=#b9b96e>-initval</font> [@ <font color=#f1b479>$resPars</font> 1] <font color=#b9b96e>-lowlim</font> [= {[@ <font color=#f1b479>$resPars</font> 1]*0.9}] <font color=#b9b96e>-uplim</font> [= {[@ <font color=#f1b479>$resPars</font> 1]*1.1}]
<font color=#f1b479>$par2</font> configure <font color=#b9b96e>-initval</font> [@ <font color=#f1b479>$resPars</font> 2] <font color=#b9b96e>-lowlim</font> [= {[@ <font color=#f1b479>$resPars</font> 2]*0.9}] <font color=#b9b96e>-uplim</font> [= {[@ <font color=#f1b479>$resPars</font> 2]*1.1}]
<font color=#f1b479>$par3</font> configure <font color=#b9b96e>-initval</font> [@ <font color=#f1b479>$resPars</font> 3] <font color=#b9b96e>-lowlim</font> [= {[@ <font color=#f1b479>$resPars</font> 3]*0.9}] <font color=#b9b96e>-uplim</font> [= {[@ <font color=#f1b479>$resPars</font> 3]*1.1}]
</pre>

</figure><p class='ruff'>The set new data in optimizer object, run and print results:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><font color=#f1b479>$optimizer</font> configure <font color=#b9b96e>-m</font> [<b><font color=#ffa500>llength</font></b> <font color=#f1b479>$vInterp</font>] <font color=#b9b96e>-pdata</font> <font color=#f1b479>$pdata</font>
<b><font color=#ffa500>set</font></b> result [<font color=#f1b479>$optimizer</font> run]
<b><font color=#ffa500>puts</font></b> [<b><font color=#ffa500>format</font></b> <font color=#90ee90>&quot;is=%.3e, n=%.3e, rs=%.3e, ikf=%.3e&quot;</font> {<b><font color=#ffa500>*</font></b>}[<b><font color=#ffa500>dget</font></b> <font color=#f1b479>$result</font> x]]
</pre>

</figure><p class='ruff'>The result is:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'>is=6.348e-17, n=1.061e+00, rs=5.232e+00, ikf=3.376e-04
</pre>

</figure><p class='ruff'>All parameters were changed to produce best fit for the whole curve.</p>
<h3 class='ruff'><a name='::Advanced-Plotting resulted data'></a>Plotting resulted data<span class='ruff-uplink'><a href='#top'>Top</a>, <a href='index.html'>Main</a>, <a href='index-docindex.html#'>Index</a></span></h3>
<div style='clear:both;'></div>
<p class='ruff'>Now we are ready to see the result of the fitting, we need to calculate curves with initial values and final values of parameters:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> initIdiode [<b><font color=#ffa500>dget</font></b> [diodeIVcalc <font color=#f1b479>$iniPars</font> <font color=#f1b479>$pdata</font>] fval]
<b><font color=#ffa500>set</font></b> fittedVIdiode [<b><font color=#ffa500>lmap</font></b> vVal <font color=#f1b479>$vInterp</font> iVal <font color=#f1b479>$fittedIdiode</font> {<b><font color=#ffa500>list</font></b> <font color=#f1b479>$vVal</font> <font color=#f1b479>$iVal</font>}]
<b><font color=#ffa500>set</font></b> initVIdiode [<b><font color=#ffa500>lmap</font></b> vVal <font color=#f1b479>$vInterp</font> iVal <font color=#f1b479>$initIdiode</font> {<b><font color=#ffa500>list</font></b> <font color=#f1b479>$vVal</font> <font color=#f1b479>$iVal</font>}]
<b><font color=#ffa500>set</font></b> viRaw [<b><font color=#ffa500>lmap</font></b> vVal <font color=#f1b479>$vRaw</font> iVal <font color=#f1b479>$iRaw</font> {<b><font color=#ffa500>list</font></b> <font color=#f1b479>$vVal</font> <font color=#f1b479>$iVal</font>}]
</pre>

</figure><p class='ruff'>Plot it with <code>ticklecharts</code> package in linear and logarithmic scales:</p>

<figure  class='ruff-snippet ruff-figure'><pre class='ruff'><b><font color=#ffa500>set</font></b> chart [ticklecharts::chart new]
<font color=#f1b479>$chart</font> Xaxis <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;v(anode), V&quot;</font> <font color=#b9b96e>-minorTick</font> {show <font color=#90ee90>&quot;True&quot;</font>}  <font color=#b9b96e>-type</font> <font color=#90ee90>&quot;value&quot;</font> <font color=#b9b96e>-splitLine</font> {show <font color=#90ee90>&quot;True&quot;</font>} <font color=#b9b96e>-min</font> <font color=#90ee90>&quot;0.4&quot;</font> <font color=#b9b96e>-max</font> <font color=#90ee90>&quot;1.6&quot;</font>
<font color=#f1b479>$chart</font> Yaxis <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;Idiode, A&quot;</font> <font color=#b9b96e>-minorTick</font> {show <font color=#90ee90>&quot;True&quot;</font>}  <font color=#b9b96e>-type</font> <font color=#90ee90>&quot;value&quot;</font> <font color=#b9b96e>-splitLine</font> {show <font color=#90ee90>&quot;True&quot;</font>} <font color=#b9b96e>-min</font> <font color=#90ee90>&quot;0.0&quot;</font> <font color=#b9b96e>-max</font> <font color=#90ee90>&quot;dataMax&quot;</font>
<font color=#f1b479>$chart</font> SetOptions <font color=#b9b96e>-title</font> {} <font color=#b9b96e>-tooltip</font> {trigger <font color=#90ee90>&quot;axis&quot;</font>} <font color=#b9b96e>-animation</font> <font color=#90ee90>&quot;False&quot;</font> <font color=#b9b96e>-legend</font> {} <font color=#b9b96e>-toolbox</font> {feature {dataZoom {yAxisIndex <font color=#90ee90>&quot;none&quot;</font>}}} <font color=#b9b96e>-grid</font> {left <font color=#90ee90>&quot;10%&quot;</font> right <font color=#90ee90>&quot;15%&quot;</font>} <font color=#b9b96e>-backgroundColor</font> <font color=#90ee90>&quot;#212121&quot;</font> 
<font color=#f1b479>$chart</font> Add <font color=#90ee90>&quot;lineSeries&quot;</font> <font color=#b9b96e>-data</font> <font color=#f1b479>$fittedVIdiode</font> <font color=#b9b96e>-showAllSymbol</font> <font color=#90ee90>&quot;nothing&quot;</font> <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;fitted&quot;</font> <font color=#b9b96e>-symbolSize</font> <font color=#90ee90>&quot;4&quot;</font> 
<font color=#f1b479>$chart</font> Add <font color=#90ee90>&quot;lineSeries&quot;</font> <font color=#b9b96e>-data</font> <font color=#f1b479>$initVIdiode</font> <font color=#b9b96e>-showAllSymbol</font> <font color=#90ee90>&quot;nothing&quot;</font> <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;unfitted&quot;</font> <font color=#b9b96e>-symbolSize</font> <font color=#90ee90>&quot;4&quot;</font>
<font color=#f1b479>$chart</font> Add <font color=#90ee90>&quot;lineSeries&quot;</font> <font color=#b9b96e>-data</font> <font color=#f1b479>$viRaw</font> <font color=#b9b96e>-showAllSymbol</font> <font color=#90ee90>&quot;nothing&quot;</font> <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;measured&quot;</font> <font color=#b9b96e>-symbolSize</font> <font color=#90ee90>&quot;4&quot;</font>
<b><font color=#ffa500>set</font></b> chartLog [ticklecharts::chart new]
<font color=#f1b479>$chartLog</font> Xaxis <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;v(anode), V&quot;</font> <font color=#b9b96e>-minorTick</font> {show <font color=#90ee90>&quot;True&quot;</font>}  <font color=#b9b96e>-type</font> <font color=#90ee90>&quot;value&quot;</font> <font color=#b9b96e>-splitLine</font> {show <font color=#90ee90>&quot;True&quot;</font>} <font color=#b9b96e>-min</font> <font color=#90ee90>&quot;0.4&quot;</font> <font color=#b9b96e>-max</font> <font color=#90ee90>&quot;1.6&quot;</font>
<font color=#f1b479>$chartLog</font> Yaxis <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;Idiode, A&quot;</font> <font color=#b9b96e>-minorTick</font> {show <font color=#90ee90>&quot;True&quot;</font>}  <font color=#b9b96e>-type</font> <font color=#90ee90>&quot;log&quot;</font> <font color=#b9b96e>-splitLine</font> {show <font color=#90ee90>&quot;True&quot;</font>} <font color=#b9b96e>-min</font> <font color=#90ee90>&quot;dataMin&quot;</font> <font color=#b9b96e>-max</font> <font color=#90ee90>&quot;0.1&quot;</font>
<font color=#f1b479>$chartLog</font> SetOptions <font color=#b9b96e>-title</font> {} <font color=#b9b96e>-tooltip</font> {trigger <font color=#90ee90>&quot;axis&quot;</font>} <font color=#b9b96e>-animation</font> <font color=#90ee90>&quot;False&quot;</font> <font color=#b9b96e>-legend</font> {} <font color=#b9b96e>-toolbox</font> {feature {dataZoom {yAxisIndex <font color=#90ee90>&quot;none&quot;</font>}}} <font color=#b9b96e>-grid</font> {left <font color=#90ee90>&quot;10%&quot;</font> right <font color=#90ee90>&quot;15%&quot;</font>} <font color=#b9b96e>-backgroundColor</font> <font color=#90ee90>&quot;#212121&quot;</font>
<font color=#f1b479>$chartLog</font> Add <font color=#90ee90>&quot;lineSeries&quot;</font> <font color=#b9b96e>-data</font> <font color=#f1b479>$fittedVIdiode</font> <font color=#b9b96e>-showAllSymbol</font> <font color=#90ee90>&quot;nothing&quot;</font> <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;fitted&quot;</font> <font color=#b9b96e>-symbolSize</font> <font color=#90ee90>&quot;4&quot;</font>
<font color=#f1b479>$chartLog</font> Add <font color=#90ee90>&quot;lineSeries&quot;</font> <font color=#b9b96e>-data</font> <font color=#f1b479>$initVIdiode</font> <font color=#b9b96e>-showAllSymbol</font> <font color=#90ee90>&quot;nothing&quot;</font> <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;unfitted&quot;</font> <font color=#b9b96e>-symbolSize</font> <font color=#90ee90>&quot;4&quot;</font>
<font color=#f1b479>$chartLog</font> Add <font color=#90ee90>&quot;lineSeries&quot;</font> <font color=#b9b96e>-data</font> <font color=#f1b479>$viRaw</font> <font color=#b9b96e>-showAllSymbol</font> <font color=#90ee90>&quot;nothing&quot;</font> <font color=#b9b96e>-name</font> <font color=#90ee90>&quot;measured&quot;</font> <font color=#b9b96e>-symbolSize</font> <font color=#90ee90>&quot;4&quot;</font>

<b><font color=#ffa500>set</font></b> layout [ticklecharts::Gridlayout new]
<font color=#f1b479>$layout</font> Add <font color=#f1b479>$chartLog</font> <font color=#b9b96e>-bottom</font> <font color=#90ee90>&quot;5%&quot;</font> <font color=#b9b96e>-height</font> <font color=#90ee90>&quot;40%&quot;</font> <font color=#b9b96e>-width</font> <font color=#90ee90>&quot;80%&quot;</font>
<font color=#f1b479>$layout</font> Add <font color=#f1b479>$chart</font> <font color=#b9b96e>-bottom</font> <font color=#90ee90>&quot;55%&quot;</font> <font color=#b9b96e>-height</font> <font color=#90ee90>&quot;40%&quot;</font> <font color=#b9b96e>-width</font> <font color=#90ee90>&quot;80%&quot;</font>

<b><font color=#ffa500>set</font></b> fbasename [<b><font color=#ffa500>file</font></b> rootname [<b><font color=#ffa500>file</font></b> tail [<b><font color=#ffa500>info</font></b> script]]]
<font color=#f1b479>$layout</font> Render <font color=#b9b96e>-outfile</font> [<b><font color=#ffa500>file</font></b> normalize [<b><font color=#ffa500>file</font></b> join .. html_charts <font color=#f1b479>$fbasename</font>.html]] <font color=#b9b96e>-height</font> 900px <font color=#b9b96e>-width</font> 700px
</pre>

</figure><p class='ruff'><!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>ticklEcharts !!!</title>
    <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/echarts@5.5.0/dist/echarts.min.js"></script>
  </head>
  <body>
    <div id="id_ff5aa8d9653f46c78f18085315b13504" class="chart-container" style="width:700px; height:900px;"></div>
    <script>
      var chart_ff5aa8d9653f46c78f18085315b13504 = echarts.init(document.getElementById("id_ff5aa8d9653f46c78f18085315b13504"), null, {renderer: "canvas"});
      var option_ff5aa8d9653f46c78f18085315b13504 = {
  "darkMode": true,
  "backgroundColor": "#212121",
  "color": [
    "#4992ff",
    "#7cffb2",
    "#fddd60",
    "#ff6e76",
    "#58d9f9",
    "#05c091",
    "#ff8a45",
    "#8d48e3",
    "#dd79ff"
  ],
  "animation": false,
  "animationDuration": 1000,
  "animationDurationUpdate": 500,
  "animationEasing": "cubicInOut",
  "animationEasingUpdate": "cubicInOut",
  "animationThreshold": 2000,
  "progressiveThreshold": 3000,
  "xAxis": [
    {
      "show": true,
      "type": "value",
      "gridIndex": 0,
      "position": "bottom",
      "name": "v(anode), V",
      "nameLocation": "end",
      "nameGap": 15,
      "nameRotate": 0,
      "inverse": false,
      "boundaryGap": true,
      "min": 0.4,
      "max": 1.6,
      "scale": false,
      "silent": false,
      "triggerEvent": false,
      "axisLine": {
        "show": true,
        "lineStyle": {
          "color": "#B9B8CE",
          "width": 1
        }
      },
      "axisTick": {"show": true},
      "minorTick": {
        "show": true,
        "splitNumber": 5,
        "length": 3
      },
      "axisLabel": {"color": "#B9B8CE"},
      "splitLine": {
        "show": true,
        "onZero": true,
        "symbol": null,
        "lineStyle": {
          "color": "#484753",
          "width": 1
        }
      },
      "zlevel": 0,
      "z": 0
    },
    {
      "show": true,
      "type": "value",
      "gridIndex": 1,
      "position": "bottom",
      "name": "v(anode), V",
      "nameLocation": "end",
      "nameGap": 15,
      "nameRotate": 0,
      "inverse": false,
      "boundaryGap": true,
      "min": 0.4,
      "max": 1.6,
      "scale": false,
      "silent": false,
      "triggerEvent": false,
      "axisLine": {
        "show": true,
        "lineStyle": {
          "color": "#B9B8CE",
          "width": 1
        }
      },
      "axisTick": {"show": true},
      "minorTick": {
        "show": true,
        "splitNumber": 5,
        "length": 3
      },
      "axisLabel": {"color": "#B9B8CE"},
      "splitLine": {
        "show": true,
        "onZero": true,
        "symbol": null,
        "lineStyle": {
          "color": "#484753",
          "width": 1
        }
      },
      "zlevel": 0,
      "z": 0
    }
  ],
  "yAxis": [
    {
      "show": true,
      "gridIndex": 0,
      "position": "left",
      "realtimeSort": true,
      "sortSeriesIndex": 0,
      "type": "log",
      "name": "Idiode, A",
      "nameLocation": "end",
      "nameGap": 15,
      "nameRotate": 0,
      "inverse": false,
      "boundaryGap": false,
      "min": "dataMin",
      "max": 0.1,
      "scale": false,
      "silent": false,
      "triggerEvent": false,
      "axisLine": {
        "show": true,
        "lineStyle": {
          "color": "#B9B8CE",
          "width": 1
        }
      },
      "axisTick": {"show": true},
      "minorTick": {
        "show": true,
        "splitNumber": 5,
        "length": 3
      },
      "axisLabel": {"color": "#B9B8CE"},
      "splitLine": {
        "show": true,
        "onZero": true,
        "symbol": null,
        "lineStyle": {
          "color": "#484753",
          "width": 1
        }
      },
      "zlevel": 0,
      "z": 0
    },
    {
      "show": true,
      "gridIndex": 1,
      "position": "left",
      "realtimeSort": true,
      "sortSeriesIndex": 0,
      "type": "value",
      "name": "Idiode, A",
      "nameLocation": "end",
      "nameGap": 15,
      "nameRotate": 0,
      "inverse": false,
      "boundaryGap": false,
      "min": 0.0,
      "max": "dataMax",
      "scale": false,
      "silent": false,
      "triggerEvent": false,
      "axisLine": {
        "show": true,
        "lineStyle": {
          "color": "#B9B8CE",
          "width": 1
        }
      },
      "axisTick": {"show": true},
      "minorTick": {
        "show": true,
        "splitNumber": 5,
        "length": 3
      },
      "axisLabel": {"color": "#B9B8CE"},
      "splitLine": {
        "show": true,
        "onZero": true,
        "symbol": null,
        "lineStyle": {
          "color": "#484753",
          "width": 1
        }
      },
      "zlevel": 0,
      "z": 0
    }
  ],
  "title": [
    {
      "show": true,
      "target": "blank",
      "textStyle": {"color": "#EEF1FA"},
      "subtarget": "blank",
      "subtextStyle": {"color": "#B9B8CE"},
      "textAlign": null,
      "textVerticalAlign": "auto",
      "padding": 5,
      "itemGap": 10,
      "z": 2,
      "left": "auto",
      "top": "auto",
      "right": "auto",
      "bottom": "auto",
      "backgroundColor": "transparent",
      "borderColor": "transparent",
      "borderWidth": 1,
      "borderRadius": 0
    },
    {
      "show": true,
      "target": "blank",
      "textStyle": {"color": "#EEF1FA"},
      "subtarget": "blank",
      "subtextStyle": {"color": "#B9B8CE"},
      "textAlign": null,
      "textVerticalAlign": "auto",
      "padding": 5,
      "itemGap": 10,
      "z": 2,
      "left": "auto",
      "top": "auto",
      "right": "auto",
      "bottom": "auto",
      "backgroundColor": "transparent",
      "borderColor": "transparent",
      "borderWidth": 1,
      "borderRadius": 0
    }
  ],
  "legend": [
    {
      "type": "plain",
      "show": true,
      "z": 2,
      "left": "center",
      "top": "auto",
      "right": "auto",
      "bottom": "auto",
      "width": "auto",
      "height": "auto",
      "orient": "horizontal",
      "align": "auto",
      "padding": 5,
      "itemGap": 10,
      "itemWidth": 25,
      "itemHeight": 14,
      "symbolRotate": "inherit",
      "selectedMode": true,
      "inactiveColor": "rgb(204, 204, 204)",
      "inactiveBorderColor": "rgb(204, 204, 204)",
      "inactiveBorderWidth": "auto",
      "textStyle": {"color": "#B9B8CE"},
      "backgroundColor": "transparent",
      "borderWidth": 0,
      "borderRadius": 0,
      "pageButtonItemGap": 5,
      "pageIconColor": "rgb(47, 69, 84)",
      "pageIconInactiveColor": "rgb(170, 170, 170)",
      "pageIconSize": 15,
      "data": [
        "fitted",
        "unfitted",
        "measured"
      ]
    },
    {
      "type": "plain",
      "show": true,
      "z": 2,
      "left": "center",
      "top": "auto",
      "right": "auto",
      "bottom": "auto",
      "width": "auto",
      "height": "auto",
      "orient": "horizontal",
      "align": "auto",
      "padding": 5,
      "itemGap": 10,
      "itemWidth": 25,
      "itemHeight": 14,
      "symbolRotate": "inherit",
      "selectedMode": true,
      "inactiveColor": "rgb(204, 204, 204)",
      "inactiveBorderColor": "rgb(204, 204, 204)",
      "inactiveBorderWidth": "auto",
      "textStyle": {"color": "#B9B8CE"},
      "backgroundColor": "transparent",
      "borderWidth": 0,
      "borderRadius": 0,
      "pageButtonItemGap": 5,
      "pageIconColor": "rgb(47, 69, 84)",
      "pageIconInactiveColor": "rgb(170, 170, 170)",
      "pageIconSize": 15,
      "data": [
        "fitted",
        "unfitted",
        "measured"
      ]
    }
  ],
  "tooltip": [
    {
      "show": true,
      "trigger": "axis",
      "showContent": true,
      "alwaysShowContent": false,
      "triggerOn": "mousemove|click",
      "transitionDuration": 0.4,
      "padding": 5,
      "order": "seriesAsc"
    },
    {
      "show": true,
      "trigger": "axis",
      "showContent": true,
      "alwaysShowContent": false,
      "triggerOn": "mousemove|click",
      "transitionDuration": 0.4,
      "padding": 5,
      "order": "seriesAsc"
    }
  ],
  "grid": [
    {
      "left": "10%",
      "right": "15%",
      "bottom": "5%",
      "width": "80%",
      "height": "40%"
    },
    {
      "left": "10%",
      "right": "15%",
      "bottom": "55%",
      "width": "80%",
      "height": "40%"
    }
  ],
  "toolbox": {
    "show": true,
    "orient": "horizontal",
    "itemSize": 15,
    "itemGap": 10,
    "showTitle": true,
    "feature": {"dataZoom": {
        "show": true,
        "filterMode": "filter",
        "yAxisIndex": "none"
      }},
    "iconStyle": {"borderColor": "#B9B8CE"},
    "z": 2,
    "top": "auto",
    "right": "auto",
    "width": "auto",
    "height": "auto",
    "24": {
      "show": true,
      "orient": "horizontal",
      "itemSize": 15,
      "itemGap": 10,
      "showTitle": true,
      "feature": {"dataZoom": {
          "show": true,
          "filterMode": "filter",
          "yAxisIndex": "none"
        }},
      "iconStyle": {"borderColor": "#B9B8CE"},
      "z": 2,
      "top": "auto",
      "right": "auto",
      "width": "auto",
      "height": "auto"
    }
  },
  "series": [
    {
      "type": "line",
      "name": "fitted",
      "colorBy": "series",
      "coordinateSystem": "cartesian2d",
      "symbol": "circle",
      "symbolSize": 4,
      "symbolKeepAspect": true,
      "showSymbol": true,
      "legendHoverLink": true,
      "stack": null,
      "cursor": "pointer",
      "connectNulls": false,
      "clip": true,
      "triggerLineEvent": false,
      "step": false,
      "label": {"color": "#B9B8CE"},
      "smooth": false,
      "data": [
        [
          0.5237,
          1.0297989377905381e-8
        ],
        [
          0.5437,
          2.139629148856237e-8
        ],
        [
          0.5637,
          4.440832156171748e-8
        ],
        [
          0.5837,
          9.20290759987008e-8
        ],
        [
          0.6037,
          1.9029699975525727e-7
        ],
        [
          0.6237,
          3.922643695697392e-7
        ],
        [
          0.6437,
          8.05005564208372e-7
        ],
        [
          0.6637,
          1.6417655051559343e-6
        ],
        [
          0.6837,
          3.319413020924644e-6
        ],
        [
          0.7037,
          6.632331059686081e-6
        ],
        [
          0.7237,
          1.3043189300815383e-5
        ],
        [
          0.7437,
          2.5127148337106275e-5
        ],
        [
          0.7637,
          4.717100054554835e-5
        ],
        [
          0.7837,
          8.585481353137747e-5
        ],
        [
          0.8037,
          0.00015086629016794473
        ],
        [
          0.8237,
          0.0002552985785009565
        ],
        [
          0.8437,
          0.0004157921995861791
        ],
        [
          0.8637,
          0.0006524726565957373
        ],
        [
          0.8837,
          0.0009886332964382794
        ],
        [
          0.9037,
          0.0014498786980342848
        ],
        [
          0.9237,
          0.0020623818302786534
        ],
        [
          0.9437,
          0.0028502338715472586
        ],
        [
          0.9637,
          0.003832441054280683
        ],
        [
          0.9837,
          0.00502052178541626
        ],
        [
          1.0037,
          0.006417518032146352
        ],
        [
          1.0237,
          0.008018620355910111
        ],
        [
          1.0437,
          0.00981295917244987
        ],
        [
          1.0637,
          0.011785829658085306
        ],
        [
          1.0837,
          0.013920734458346323
        ],
        [
          1.1037,
          0.0162009286338497
        ],
        [
          1.1237,
          0.018610416817295278
        ],
        [
          1.1437,
          0.02113449679339202
        ],
        [
          1.1637,
          0.023759984230881936
        ],
        [
          1.1837,
          0.026475238825504566
        ],
        [
          1.2037,
          0.029270080261968923
        ],
        [
          1.2237,
          0.032135651908883844
        ],
        [
          1.2437,
          0.0350642670655712
        ],
        [
          1.2637,
          0.038049257050353835
        ],
        [
          1.2837,
          0.04108483074677946
        ],
        [
          1.3037,
          0.04416594955067166
        ],
        [
          1.3237,
          0.047288218525820436
        ],
        [
          1.3437,
          0.050447792971737127
        ],
        [
          1.3637,
          0.053641298886583005
        ],
        [
          1.3837,
          0.056865765576258
        ],
        [
          1.4037,
          0.06011856868276377
        ],
        [
          1.4237,
          0.0633973820474047
        ],
        [
          1.4437,
          0.06670013701309724
        ],
        [
          1.4637,
          0.07002498796594678
        ],
        [
          1.4837,
          0.07337028310012725
        ]
      ],
      "zlevel": 0,
      "z": 2,
      "silent": false,
      "xAxisIndex": 0,
      "yAxisIndex": 0
    },
    {
      "type": "line",
      "name": "unfitted",
      "colorBy": "series",
      "coordinateSystem": "cartesian2d",
      "symbol": "circle",
      "symbolSize": 4,
      "symbolKeepAspect": true,
      "showSymbol": true,
      "legendHoverLink": true,
      "stack": null,
      "cursor": "pointer",
      "connectNulls": false,
      "clip": true,
      "triggerLineEvent": false,
      "step": false,
      "label": {"color": "#B9B8CE"},
      "smooth": false,
      "data": [
        [
          0.5237,
          4.1877896781068735e-6
        ],
        [
          0.5437,
          8.348648078630727e-6
        ],
        [
          0.5637,
          1.612673960936853e-5
        ],
        [
          0.5837,
          2.998549717995666e-5
        ],
        [
          0.6037,
          5.3384807480419405e-5
        ],
        [
          0.6237,
          9.073335923007186e-5
        ],
        [
          0.6437,
          0.00014715433186027194
        ],
        [
          0.6637,
          0.00022810518770444502
        ],
        [
          0.6837,
          0.00033887814859967155
        ],
        [
          0.7037,
          0.00048400854393001666
        ],
        [
          0.7237,
          0.0006666996840118504
        ],
        [
          0.7437,
          0.0008884489037545087
        ],
        [
          0.7637,
          0.0011490111635874788
        ],
        [
          0.7837,
          0.0014466849098310613
        ],
        [
          0.8037,
          0.0017787768276211584
        ],
        [
          0.8237,
          0.0021420788866127645
        ],
        [
          0.8437,
          0.0025332499122555814
        ],
        [
          0.8637,
          0.002949068557224252
        ],
        [
          0.8837,
          0.003386572887266563
        ],
        [
          0.9037,
          0.003843118991687832
        ],
        [
          0.9237,
          0.004316389560474258
        ],
        [
          0.9437,
          0.0048043753447069674
        ],
        [
          0.9637,
          0.0053053442678656845
        ],
        [
          0.9837,
          0.005817806806053004
        ],
        [
          1.0037,
          0.0063404822168207225
        ],
        [
          1.0237,
          0.006872267763705163
        ],
        [
          1.0437,
          0.007412211714294507
        ],
        [
          1.0637,
          0.007959490170777898
        ],
        [
          1.0837,
          0.008513387449365625
        ],
        [
          1.1037,
          0.0090732795898051
        ],
        [
          1.1237,
          0.00963862054929399
        ],
        [
          1.1437,
          0.010208930660379895
        ],
        [
          1.1637,
          0.010783786979417204
        ],
        [
          1.1837,
          0.011362815204926442
        ],
        [
          1.2037,
          0.01194568289601752
        ],
        [
          1.2237,
          0.012532093766559442
        ],
        [
          1.2437,
          0.013121782869964713
        ],
        [
          1.2637,
          0.013714512522405343
        ],
        [
          1.2837,
          0.014310068839582146
        ],
        [
          1.3037,
          0.014908258784600836
        ],
        [
          1.3237,
          0.015508907642839711
        ],
        [
          1.3437,
          0.016111856854636144
        ],
        [
          1.3637,
          0.01671696214878522
        ],
        [
          1.3837,
          0.017324091929752282
        ],
        [
          1.4037,
          0.017933125879580514
        ],
        [
          1.4237,
          0.018543953742071694
        ],
        [
          1.4437,
          0.0191564742622184
        ],
        [
          1.4637,
          0.019770594258296303
        ],
        [
          1.4837,
          0.02038622780766929
        ]
      ],
      "zlevel": 0,
      "z": 2,
      "silent": false,
      "xAxisIndex": 0,
      "yAxisIndex": 0
    },
    {
      "type": "line",
      "name": "measured",
      "colorBy": "series",
      "coordinateSystem": "cartesian2d",
      "symbol": "circle",
      "symbolSize": 4,
      "symbolKeepAspect": true,
      "showSymbol": true,
      "legendHoverLink": true,
      "stack": null,
      "cursor": "pointer",
      "connectNulls": false,
      "clip": true,
      "triggerLineEvent": false,
      "step": false,
      "label": {"color": "#B9B8CE"},
      "smooth": false,
      "data": [
        [
          0.5237,
          0.0000000125
        ],
        [
          0.5481,
          0.0000000305
        ],
        [
          0.5755,
          0.000000071
        ],
        [
          0.5998,
          0.000000165
        ],
        [
          0.6242,
          0.000000394
        ],
        [
          0.6495,
          0.000000929
        ],
        [
          0.6731,
          0.00000221
        ],
        [
          0.6982,
          0.00000492
        ],
        [
          0.7242,
          0.0000111
        ],
        [
          0.7492,
          0.0000238
        ],
        [
          0.7744,
          0.0000517
        ],
        [
          0.7995,
          0.000107
        ],
        [
          0.8239,
          0.000217
        ],
        [
          0.8498,
          0.000431
        ],
        [
          0.875,
          0.000814
        ],
        [
          0.9001,
          0.00144
        ],
        [
          0.9252,
          0.00234
        ],
        [
          0.9496,
          0.0035
        ],
        [
          0.9755,
          0.00508
        ],
        [
          1.0006,
          0.00702
        ],
        [
          1.0246,
          0.0087
        ],
        [
          1.0492,
          0.0109
        ],
        [
          1.0738,
          0.0132
        ],
        [
          1.0984,
          0.0158
        ],
        [
          1.1238,
          0.0187
        ],
        [
          1.1502,
          0.0216
        ],
        [
          1.1748,
          0.0247
        ],
        [
          1.2002,
          0.028
        ],
        [
          1.224,
          0.0313
        ],
        [
          1.2494,
          0.0349
        ],
        [
          1.2749,
          0.0386
        ],
        [
          1.2995,
          0.0424
        ],
        [
          1.3241,
          0.0463
        ],
        [
          1.3504,
          0.0502
        ],
        [
          1.375,
          0.0544
        ],
        [
          1.4014,
          0.0585
        ],
        [
          1.4242,
          0.0629
        ],
        [
          1.4487,
          0.0673
        ],
        [
          1.4761,
          0.0716
        ],
        [
          1.4998,
          0.076
        ]
      ],
      "zlevel": 0,
      "z": 2,
      "silent": false,
      "xAxisIndex": 0,
      "yAxisIndex": 0
    },
    {
      "type": "line",
      "name": "fitted",
      "colorBy": "series",
      "coordinateSystem": "cartesian2d",
      "symbol": "circle",
      "symbolSize": 4,
      "symbolKeepAspect": true,
      "showSymbol": true,
      "legendHoverLink": true,
      "stack": null,
      "cursor": "pointer",
      "connectNulls": false,
      "clip": true,
      "triggerLineEvent": false,
      "step": false,
      "label": {"color": "#B9B8CE"},
      "smooth": false,
      "data": [
        [
          0.5237,
          1.0297989377905381e-8
        ],
        [
          0.5437,
          2.139629148856237e-8
        ],
        [
          0.5637,
          4.440832156171748e-8
        ],
        [
          0.5837,
          9.20290759987008e-8
        ],
        [
          0.6037,
          1.9029699975525727e-7
        ],
        [
          0.6237,
          3.922643695697392e-7
        ],
        [
          0.6437,
          8.05005564208372e-7
        ],
        [
          0.6637,
          1.6417655051559343e-6
        ],
        [
          0.6837,
          3.319413020924644e-6
        ],
        [
          0.7037,
          6.632331059686081e-6
        ],
        [
          0.7237,
          1.3043189300815383e-5
        ],
        [
          0.7437,
          2.5127148337106275e-5
        ],
        [
          0.7637,
          4.717100054554835e-5
        ],
        [
          0.7837,
          8.585481353137747e-5
        ],
        [
          0.8037,
          0.00015086629016794473
        ],
        [
          0.8237,
          0.0002552985785009565
        ],
        [
          0.8437,
          0.0004157921995861791
        ],
        [
          0.8637,
          0.0006524726565957373
        ],
        [
          0.8837,
          0.0009886332964382794
        ],
        [
          0.9037,
          0.0014498786980342848
        ],
        [
          0.9237,
          0.0020623818302786534
        ],
        [
          0.9437,
          0.0028502338715472586
        ],
        [
          0.9637,
          0.003832441054280683
        ],
        [
          0.9837,
          0.00502052178541626
        ],
        [
          1.0037,
          0.006417518032146352
        ],
        [
          1.0237,
          0.008018620355910111
        ],
        [
          1.0437,
          0.00981295917244987
        ],
        [
          1.0637,
          0.011785829658085306
        ],
        [
          1.0837,
          0.013920734458346323
        ],
        [
          1.1037,
          0.0162009286338497
        ],
        [
          1.1237,
          0.018610416817295278
        ],
        [
          1.1437,
          0.02113449679339202
        ],
        [
          1.1637,
          0.023759984230881936
        ],
        [
          1.1837,
          0.026475238825504566
        ],
        [
          1.2037,
          0.029270080261968923
        ],
        [
          1.2237,
          0.032135651908883844
        ],
        [
          1.2437,
          0.0350642670655712
        ],
        [
          1.2637,
          0.038049257050353835
        ],
        [
          1.2837,
          0.04108483074677946
        ],
        [
          1.3037,
          0.04416594955067166
        ],
        [
          1.3237,
          0.047288218525820436
        ],
        [
          1.3437,
          0.050447792971737127
        ],
        [
          1.3637,
          0.053641298886583005
        ],
        [
          1.3837,
          0.056865765576258
        ],
        [
          1.4037,
          0.06011856868276377
        ],
        [
          1.4237,
          0.0633973820474047
        ],
        [
          1.4437,
          0.06670013701309724
        ],
        [
          1.4637,
          0.07002498796594678
        ],
        [
          1.4837,
          0.07337028310012725
        ]
      ],
      "zlevel": 0,
      "z": 2,
      "silent": false,
      "xAxisIndex": 1,
      "yAxisIndex": 1
    },
    {
      "type": "line",
      "name": "unfitted",
      "colorBy": "series",
      "coordinateSystem": "cartesian2d",
      "symbol": "circle",
      "symbolSize": 4,
      "symbolKeepAspect": true,
      "showSymbol": true,
      "legendHoverLink": true,
      "stack": null,
      "cursor": "pointer",
      "connectNulls": false,
      "clip": true,
      "triggerLineEvent": false,
      "step": false,
      "label": {"color": "#B9B8CE"},
      "smooth": false,
      "data": [
        [
          0.5237,
          4.1877896781068735e-6
        ],
        [
          0.5437,
          8.348648078630727e-6
        ],
        [
          0.5637,
          1.612673960936853e-5
        ],
        [
          0.5837,
          2.998549717995666e-5
        ],
        [
          0.6037,
          5.3384807480419405e-5
        ],
        [
          0.6237,
          9.073335923007186e-5
        ],
        [
          0.6437,
          0.00014715433186027194
        ],
        [
          0.6637,
          0.00022810518770444502
        ],
        [
          0.6837,
          0.00033887814859967155
        ],
        [
          0.7037,
          0.00048400854393001666
        ],
        [
          0.7237,
          0.0006666996840118504
        ],
        [
          0.7437,
          0.0008884489037545087
        ],
        [
          0.7637,
          0.0011490111635874788
        ],
        [
          0.7837,
          0.0014466849098310613
        ],
        [
          0.8037,
          0.0017787768276211584
        ],
        [
          0.8237,
          0.0021420788866127645
        ],
        [
          0.8437,
          0.0025332499122555814
        ],
        [
          0.8637,
          0.002949068557224252
        ],
        [
          0.8837,
          0.003386572887266563
        ],
        [
          0.9037,
          0.003843118991687832
        ],
        [
          0.9237,
          0.004316389560474258
        ],
        [
          0.9437,
          0.0048043753447069674
        ],
        [
          0.9637,
          0.0053053442678656845
        ],
        [
          0.9837,
          0.005817806806053004
        ],
        [
          1.0037,
          0.0063404822168207225
        ],
        [
          1.0237,
          0.006872267763705163
        ],
        [
          1.0437,
          0.007412211714294507
        ],
        [
          1.0637,
          0.007959490170777898
        ],
        [
          1.0837,
          0.008513387449365625
        ],
        [
          1.1037,
          0.0090732795898051
        ],
        [
          1.1237,
          0.00963862054929399
        ],
        [
          1.1437,
          0.010208930660379895
        ],
        [
          1.1637,
          0.010783786979417204
        ],
        [
          1.1837,
          0.011362815204926442
        ],
        [
          1.2037,
          0.01194568289601752
        ],
        [
          1.2237,
          0.012532093766559442
        ],
        [
          1.2437,
          0.013121782869964713
        ],
        [
          1.2637,
          0.013714512522405343
        ],
        [
          1.2837,
          0.014310068839582146
        ],
        [
          1.3037,
          0.014908258784600836
        ],
        [
          1.3237,
          0.015508907642839711
        ],
        [
          1.3437,
          0.016111856854636144
        ],
        [
          1.3637,
          0.01671696214878522
        ],
        [
          1.3837,
          0.017324091929752282
        ],
        [
          1.4037,
          0.017933125879580514
        ],
        [
          1.4237,
          0.018543953742071694
        ],
        [
          1.4437,
          0.0191564742622184
        ],
        [
          1.4637,
          0.019770594258296303
        ],
        [
          1.4837,
          0.02038622780766929
        ]
      ],
      "zlevel": 0,
      "z": 2,
      "silent": false,
      "xAxisIndex": 1,
      "yAxisIndex": 1
    },
    {
      "type": "line",
      "name": "measured",
      "colorBy": "series",
      "coordinateSystem": "cartesian2d",
      "symbol": "circle",
      "symbolSize": 4,
      "symbolKeepAspect": true,
      "showSymbol": true,
      "legendHoverLink": true,
      "stack": null,
      "cursor": "pointer",
      "connectNulls": false,
      "clip": true,
      "triggerLineEvent": false,
      "step": false,
      "label": {"color": "#B9B8CE"},
      "smooth": false,
      "data": [
        [
          0.5237,
          0.0000000125
        ],
        [
          0.5481,
          0.0000000305
        ],
        [
          0.5755,
          0.000000071
        ],
        [
          0.5998,
          0.000000165
        ],
        [
          0.6242,
          0.000000394
        ],
        [
          0.6495,
          0.000000929
        ],
        [
          0.6731,
          0.00000221
        ],
        [
          0.6982,
          0.00000492
        ],
        [
          0.7242,
          0.0000111
        ],
        [
          0.7492,
          0.0000238
        ],
        [
          0.7744,
          0.0000517
        ],
        [
          0.7995,
          0.000107
        ],
        [
          0.8239,
          0.000217
        ],
        [
          0.8498,
          0.000431
        ],
        [
          0.875,
          0.000814
        ],
        [
          0.9001,
          0.00144
        ],
        [
          0.9252,
          0.00234
        ],
        [
          0.9496,
          0.0035
        ],
        [
          0.9755,
          0.00508
        ],
        [
          1.0006,
          0.00702
        ],
        [
          1.0246,
          0.0087
        ],
        [
          1.0492,
          0.0109
        ],
        [
          1.0738,
          0.0132
        ],
        [
          1.0984,
          0.0158
        ],
        [
          1.1238,
          0.0187
        ],
        [
          1.1502,
          0.0216
        ],
        [
          1.1748,
          0.0247
        ],
        [
          1.2002,
          0.028
        ],
        [
          1.224,
          0.0313
        ],
        [
          1.2494,
          0.0349
        ],
        [
          1.2749,
          0.0386
        ],
        [
          1.2995,
          0.0424
        ],
        [
          1.3241,
          0.0463
        ],
        [
          1.3504,
          0.0502
        ],
        [
          1.375,
          0.0544
        ],
        [
          1.4014,
          0.0585
        ],
        [
          1.4242,
          0.0629
        ],
        [
          1.4487,
          0.0673
        ],
        [
          1.4761,
          0.0716
        ],
        [
          1.4998,
          0.076
        ]
      ],
      "zlevel": 0,
      "z": 2,
      "silent": false,
      "xAxisIndex": 1,
      "yAxisIndex": 1
    }
  ]
};
      chart_ff5aa8d9653f46c78f18085315b13504.setOption(option_ff5aa8d9653f46c78f18085315b13504);
    </script>
  </body>
</html>
</p>
<p class='ruff'>On the plot we can see the initial simulated curve, the measured data and the final fitting result.</p>
</main><nav class='ruff-nav'><ul ><li class='ruff-toc1'><a style='padding-top:2px;' href='index.html'>Start page</a></li>
<li class='ruff-toc1'><a href='index-docindex.html' accesskey='i'>Index</a></li>
<hr>
<li class='ruff-toc1'><a href='index-List-of-devices.html'>List of devices</a></li>
<li class='ruff-toc1'><a href='index-FAQ.html'>FAQ</a></li>
<li class='ruff-toc1'><a href='index-Tutorials.html'>Tutorials</a></li>
<li class='ruff-toc1'><a href='index-Tips.html'>Tips</a></li>
<li class='ruff-toc1'><a class='ruff-highlight' href='index-Advanced.html'>Advanced</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl.html'>SpiceGenTcl</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Common-BasicDevices.html'>SpiceGenTcl::Common::BasicDevices</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Common-Analyses.html'>SpiceGenTcl::Common::Analyses</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Common-Sources.html'>SpiceGenTcl::Common::Sources</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ngspice-BasicDevices.html'>SpiceGenTcl::Ngspice::BasicDevices</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ngspice-Sources.html'>SpiceGenTcl::Ngspice::Sources</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ngspice-SemiconductorDevices.html'>SpiceGenTcl::Ngspice::SemiconductorDevices</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ngspice-Analyses.html'>SpiceGenTcl::Ngspice::Analyses</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ngspice-Simulators.html'>SpiceGenTcl::Ngspice::Simulators</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Xyce-BasicDevices.html'>SpiceGenTcl::Xyce::BasicDevices</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Xyce-Sources.html'>SpiceGenTcl::Xyce::Sources</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Xyce-SemiconductorDevices.html'>SpiceGenTcl::Xyce::SemiconductorDevices</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Xyce-Analyses.html'>SpiceGenTcl::Xyce::Analyses</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Xyce-Simulators.html'>SpiceGenTcl::Xyce::Simulators</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ltspice-BasicDevices.html'>SpiceGenTcl::Ltspice::BasicDevices</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ltspice-Sources.html'>SpiceGenTcl::Ltspice::Sources</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ltspice-SemiconductorDevices.html'>SpiceGenTcl::Ltspice::SemiconductorDevices</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ltspice-Analyses.html'>SpiceGenTcl::Ltspice::Analyses</a></li>
<li class='ruff-toc1'><a href='index-SpiceGenTcl-Ltspice-Simulators.html'>SpiceGenTcl::Ltspice::Simulators</a></li>
<hr><li class='ruff-toc2'><a href='#::Advanced-Monte-Carlo simulation'>Monte-Carlo simulation</a></li><li class='ruff-toc2'><a href='#::Advanced-Parameters extraction of diode model parameters'>Parameters extraction of diode model parameters</a></li><li class='ruff-toc3'><a href='#::Advanced-Fitting in first region'>Fitting in first region</a></li><li class='ruff-toc3'><a href='#::Advanced-Fitting in second region'>Fitting in second region</a></li><li class='ruff-toc3'><a href='#::Advanced-Fitting the whole curve'>Fitting the whole curve</a></li><li class='ruff-toc3'><a href='#::Advanced-Plotting resulted data'>Plotting resulted data</a></li></ul></nav><footer class='ruff-layout-footer ruff-ft'><div style='float: right;'>Document generated by <a href='https://ruff.magicsplat.com'>Ruff!</a></div><div>&copy; George Yashin</div></footer>
</div></body></html>
